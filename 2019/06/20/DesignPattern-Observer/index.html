
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="VictoryWoo">
    <title>[Design Pattern] 옵저버 패턴 - VictoryWoo</title>
    <meta name="author" content="VictoryWoo">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"VictoryWoo","sameAs":["https://github.com/WooVictory","https://www.facebook.com/WooVictory","https://www.linkedin.com/profile/","jhsw0375@gmail.com"],"image":"Victory.jpeg"},"articleBody":"옵저버 패턴이란\n\n한 객체의 상태 변화에 따라 다른 객체의 상태도 연동되도록 하고 자동으로 내용이 갱신되는 방식으로 일대다 객체 의존 관계를 구성하는 패턴이다.\n데이터의 변경이 발생했을 경우 상대 클래스나 객체에 의존하지 않으면서 데이터 변경을 통보하고자 할 때 유용하다.\n\nex) 새로운 파일이 추가되거나 기존 파일이 삭제되었을 때 탐색기는 다른 탐색기에게 즉시 변경을 통보해야 한다.\nex) 차량 연료량 클래스는 연료량이 부족한 경우 연료량에 관심을 가지는 구체적인 클래스에 직접 의존하지 않는 방식으로 연료량 변화를 통보해야 한다.\n‘행위 패턴’ 중 하나\n\n\n\n\n\n옵저버 패턴은 통보 대상 객체의 관리를 Subject 클래스와 Observer 인터페이스로 일반화한다.\n\n이를 통해 데이터 변경을 통보하는 클래스는 통보 대상 클래스나 객체에 대한 의존성을 없앨 수 있다.\n결과적으로 통보 대상 클래스나 대상 객체의 변경에도 통보하는 클래스(ConcreteSubject)를 수정없이 그대로 사용할 수 있다.\n대부분 상태를 저장하고 있는 주제 인터페이스를 구현한 하나의 주제 객체와 주제 객체에 의존하고 있는 옵저버 인터페이스를 구현한 여러 개의 옵저버 객체가 있는 디자인을 바탕으로 한다. 결국, 위와 같은 의미이다.\n\n\n\n역할이 수행하는 작업\n\nObserver\n\n데이터의 변경을 통보 받는 인터페이스\n즉, Subject에서는 Observer 인터페이스의 update 메소드를 호출함으로써 ConcreteSubject의 데이터 변경을 ConcreteObserver에게 통보한다.\n\n\nSubject\n\nConcreteObserver 객체를 관리하는 요소\nObserver 인터페이스를 참조해서 ConcreteObserver를 관리하므로 ConcreteObserver의 변화에 독립적일 수 있다.\n\n\nConcreteSubject\n\n변경 관리 대상이 되는 데이터가 있는 클래스(통보하는 클래스)\n데이터 변경을 위한 setState 메소드가 있다.\nsetState 메소드에서는 자신의 데이터인 subjectState를 변경하고 Subject의 nofityObservers 메소드를 호출해서 ConcreteObserver 객체에 변경을 통보한다.\n\n\nConcreteObserver\n\nConcreteSubject의 변경을 통보 받는 클래스\nObserver 인터페이스의 update 메소드를 구현함으로써 변경을 통보받는다.\n변경된 데이터는 ConcreteSubject의 getState 메소드를 호출함으로써 변경을 조회한다.\n\n\n\n예시\n\n- 여러 가지 방식으로 성적을 출력해보기.\n- 입력된 성적 값을 출력하는 프로그램\nScoreRecord 클래스\n12345678910111213141516171819202122/*** 입력된 점수를 저장하는 클래스*/public class ScoreRecord &#123;    private List&lt;Integer&gt; scores = new ArrayList&lt;&gt;();    private DataSheetView dataSheetView;    public void setDataSheetView(DataSheetView dataSheetView) &#123;        this.dataSheetView = dataSheetView;    &#125;    // 새로운 점수를 추가하면 출력하는 것에 변화를 통보(update())하여 출력하는 부분 갱신.    public void addScore(int score) &#123;        scores.add(score); // scores 목록에 주어진 점수를 추가한다.        dataSheetView.update();    &#125;    // 출력하는 부분에서 변화된 내용을 얻어감.    public List&lt;Integer&gt; getScoreRecord() &#123;        return scores;    &#125;&#125;\nDataSheetView 클래스\n123456789101112131415161718192021222324252627/** * 1. 출력 형태 : 목록 형태로 출력하는 클래스 */public class DataSheetView &#123;    private ScoreRecord scoreRecord;    private int viewCount;    public DataSheetView(ScoreRecord scoreRecord, int viewCount) &#123;        this.scoreRecord = scoreRecord;        this.viewCount = viewCount;    &#125;    // 점수의 변경을 통보 받는다.    public void update() &#123;        List&lt;Integer&gt; record = scoreRecord.getScoreRecord(); // 점수를 조회한다.        displayScores(record, viewCount); // 조회된 점수를 viewCount 만큼만 출력한다.    &#125;    // 점수를 출력한다.    private void displayScores(List&lt;Integer&gt; record, int viewCount) &#123;        System.out.println(\"List of \" + viewCount + \" entries: \");        for (int i = 0; i &lt; viewCount &amp;&amp; i &lt; record.size(); i++) &#123;            System.out.println(record.get(i) + \" \");        &#125;        System.out.println();    &#125;&#125;\nObserverClient 클래스\n12345678910111213141516public class ObserverClient &#123;    public static void main(String[] args) &#123;        ScoreRecord scoreRecord = new ScoreRecord();        // 3개까지의 점수만 출력.        DataSheetView dataSheetView = new DataSheetView(scoreRecord, 3);        scoreRecord.setDataSheetView(dataSheetView);        for (int i = 1; i &lt;= 5; i++) &#123;            int score = i * 10;            System.out.println(\"Adding : \" + score);            // 10, 20, 30, 40, 50을 추가한다.            // 추가할 때마다 최대 3개의 점수만 출력한다.            scoreRecord.addScore(score);        &#125;    &#125;&#125;\n\nScoreRecord 클래스의 addScore() 메소드가 호출되면 ScoreRecord 클래스는 자신의 필드인 scores 객체에 점수를 추가한다.\n\n그리고 DataSheetView 클래스의 update() 메소드를 호출함으로써 성적을 출력하도록 요청한다.\n\n\nDataSheetView 클래스는 ScoreRecord 클래스의 getScoreRecord() 메소드를 호출해 출력할 점수를 구한다.\n\n이때 DataSheetView 클래스의 update() 메소드에서는 구한 점수 중에서 명시된 개수만큼(viewCount)의 점수만 출력한다.\n\n\n\n문제점\n\n성적을 다른 형태로 출력하는 경우\n\n\n성적을 목록으로 출력하지 않고 성적의 최소, 최대 값만 출력하려면?\n\n1234567891011121314151617public class ScoreRecord &#123;    private List&lt;Integer&gt; scores = new ArrayList&lt;&gt;();    private MinMaxView minMaxView;    public void setMinMaxView(MinMaxView minMaxView) &#123;        this.minMaxView = minMaxView;    &#125;    public void addScore(int score) &#123;        scores.add(score);        minMaxView.update();    &#125;    public List&lt;Integer&gt; getScoreRecord() &#123;        return scores;    &#125;&#125;\n점수 변경에 대한 통보 대상 클래스가 다른 대상 클래스(DataSheetView -&gt; MinMaxView)로 바뀌면 기존 코드(ScoredRecord 클래스)의 내용을 수정해야 하므로 OCP에 위배된다.\n\n동시 혹은 순차적으로 성적을 출력하는 경우\n\n\n성적이 입력되었을 때 최대 3개 목록, 최대 5개 목록, 최소/최대 값을 동시에 출력하려면?\n처음에는 목록으로 출력하고 나중에는 최소/최대 값을 출력하려면?\n\n123456789101112131415161718192021222324public class ScoreRecord &#123;    private List&lt;Integer&gt; scores = new ArrayList&lt;&gt;();    private MinMaxView minMaxView;    private DataSheetView dataSheetView;    public void setMinMaxView(MinMaxView minMaxView) &#123;        this.minMaxView = minMaxView;    &#125;    public void setDataSheetView(DataSheetView dataSheetView)&#123;        this.dataSheetView = dataSheetView;    &#125;    // 새로운 점수를 추가하면 출력하는 것에 변화를 통보(update())하여 출력하는 부분을 갱신한다.    public void addScore(int score) &#123;        scores.add(score);        dataSheetView.update(); // scores가 변경됨을 통보한다.        minMaxView.update(); // scores가 변경됨을 통보한다.    &#125;    public List&lt;Integer&gt; getScoreRecord() &#123;        return scores;    &#125;&#125;\n이 경우에도 점수 변경에 대한 통보 대상 클래스가 다른 클래스로 바뀌면(DataSheetView -&gt; MinMaxView) 기존 코드의 내용을 수정해야 하므로 OCP에 위배된다.\n즉, 성적 변경을 새로운 클래스에 통보할 때마다 ScoreRecord 클래스의 코드를 수정해야 하므로 번거롭고 재사용하기가 어렵다.\n\n위의 그림처럼 양방향의 의존 관계를 가지고 있기 때문에 통보 대상 클래스가 변경되면 ScoreRecord 클래스도 수정해야 한다. 따라서 우리는 이 문제를 해결해야 한다.\n해결책\n문제를 해결하기 위해서는 공통 기능을 상위 클래스 및 인터페이스로 일반화하고 이를 활용하여 통보하는 클래스를 구현해야 한다.\n\n즉, ScoreRecord 클래스에서 변화되는 부분을 식별하고 이를 일반화시켜야 한다.\n이를 통해 성적 통보 대상이 변경되더라도 ScoreRecord 클래스를 그대로 재사용할 수 있다.\nScoreRecord 클래스에서 하는 작업\n\n통보 대상인 객체를 참조하는 것을 관리(추가/제거) -&gt; Subject 클래스로 일반화\naddScore 메소드 : 각 통보 대상인 객체의 update() 메소드를 호출 -&gt; Observer 인터페이스로 일반화\n\n\n\n\n\nScoreRecord 클래스의 addScore(상태 변경) 메소드 호출\n\n자신의 성적 값을 저장한다.\n상태가 변경될 때마다 Subject 클래스의 notifyObservers() 메소드를 호출한다.\n\n\nSubject 클래스의 notifyObservers() 메소드 호출\n\nObserver 인터페이스를 통해 성적 변경을 통보한다.\nDataSheetView 클래스의 update() 메소드 호출\nMinMaxView 클래스의 update() 메소드 호출\n\n\n\n개선 시킨 후의 코드\nObserver 인터페이스\n1234public interface Observer &#123;    // 데이터 변경을 통보했을 때 처리하는 메소드    void update();&#125;\nSubject 클래스\n123456789101112131415161718192021222324252627/** * 추상화된 변경 관심 데이터 * 즉, 데이터에 공통적으로 들어가야 하는 메소드들 -&gt; 일반화 */public abstract class Subject &#123;    // 추상화된 통보 대상 목록.    // 즉, 출력 형태에 대한 Observer    private List&lt;Observer&gt; observers = new ArrayList&lt;Observer&gt;();    // 통보 대상 추가.    public void attach(Observer observer) &#123;        observers.add(observer);    &#125;    // 통보 대상 제거.    public void detach(Observer observer) &#123;        observers.remove(observer);    &#125;    // 각 통보 대상에게 변경을 통보한다.    public void notifyObservers() &#123;        for (Observer observer : observers) &#123;            observer.update();        &#125;    &#125;&#125;\nScoreRecord 클래스\n1234567891011121314151617/** * 구체적인 감시 대상 데이터 * 출력 형태 2개를 가질 때 */public class ScoreRecord extends Subject &#123;    private List&lt;Integer&gt; scores = new ArrayList&lt;&gt;();    // 새로운 점수를 추가. -&gt; 상태 변경    public void addScore(int score) &#123;        scores.add(score); // scores 목록에 주어진 점수를 추가한다.        notifyObservers(); // scores 가 변경됨을 각 통보 대상에게 통보한다.    &#125;    public List&lt;Integer&gt; getScoreRecord() &#123;        return scores;    &#125;&#125;\nDataSheetView 클래스\n12345678910111213141516171819202122232425262728/** * 1. 출력 형태 : 목록 형태로 출력하는 클래스 */public class DataSheetView implements Observer &#123;    private ScoreRecord scoreRecord;    private int viewCount;    public DataSheetView(ScoreRecord scoreRecord, int viewCount) &#123;        this.scoreRecord = scoreRecord;        this.viewCount = viewCount;    &#125;    // 점수를 출력한다.    private void displayScores(List&lt;Integer&gt; record, int viewCount) &#123;        System.out.println(\"List of \" + viewCount + \" entries: \");        for (int i = 0; i &lt; viewCount &amp;&amp; i &lt; record.size(); i++) &#123;            System.out.println(record.get(i) + \" \");        &#125;        //System.out.println();    &#125;    // 점수의 변경을 통보 받는다.    @Override    public void update() &#123;        List&lt;Integer&gt; record = scoreRecord.getScoreRecord(); // 점수를 조회한다.        displayScores(record, viewCount); // 조회된 점수를 viewCount 만큼만 출력한다.    &#125;&#125;\nMinMaxView 클래스\n1234567891011121314151617181920212223/** * 2. 출력 형태 : 최대, 최소 값만을 출력한다. */public class MinMaxView implements Observer &#123;    private ScoreRecord scoreRecord;    public MinMaxView(ScoreRecord scoreRecord) &#123;        this.scoreRecord = scoreRecord;    &#125;    private void displayScores(List&lt;Integer&gt; record) &#123;        int min = Collections.min(record);        int max = Collections.max(record);        System.out.println(\"Min : \" + min + \", Max : \" + max);    &#125;    @Override    public void update() &#123;        List&lt;Integer&gt; record = scoreRecord.getScoreRecord();        displayScores(record);    &#125;&#125;\nObserverClient 클래스에서의 사용\n123456789101112131415161718192021public class ObserverClient &#123;    public static void main(String[] args) &#123;        ScoreRecord scoreRecord = new ScoreRecord();        // 3개까지만 데이터를 출력한다.        DataSheetView dataSheetView = new DataSheetView(scoreRecord, 3);        // 최대, 최소 값만 출력한다.        MinMaxView minMaxView = new MinMaxView(scoreRecord);        // 각 통보 대상 클래스를 Observer 로 추가한다.        scoreRecord.attach(dataSheetView);        scoreRecord.attach(minMaxView);        for (int i = 1; i &lt;= 5; i++) &#123;            int score = i * 10;            System.out.println();            System.out.println(\"Adding : \" + score);            scoreRecord.addScore(score);        &#125;    &#125;&#125;\n\nObserver : 추상화된 통보 대상\nDataSheetView, MinMaxView : Observer를 구현함으로써 구체적인 통보 대상이 된다.\nSubject : 성적 변경에 관심이 있는 대상 객체들을 관리한다.\nScoreRecord : Subject를 상속받음으로써 구체적인 통보 대상을 직접 참조하지 않아도 된다. notifyObservers()를 호출함으로써 Subject 클래스에서 각 통보 대상들에게 변경 사항을 통보한다.\n이렇게 Observer 패턴을 이용하면 ScoreRecord 클래스의 코드를 변경하지 않고도 새로운 관심 클래스 및 객체를 추가/제거하는 것이 가능해진다.\n\n느낀 점\n결국, 처음에는 양방향으로 참조를 해서 강한 의존성을 갖고 있었다. 하지만, Observer 패턴을 적용함으로써 의존성을 약하게 결합하도록 하고 양방향 참조를 하지 않도록 함으로써 디자인 원칙을 위배하지 않으면서 데이터 변경을 적절하게 통보할 수 있게 되었다.\n이처럼 느슨하게 결합하는 디자인을 사용하면 변경 사항이 생겨도 무난하게 처리할 수 있는 유연한 객체지향 시스템을 구축할 수 있다. (객체 사이의 상호 의존성을 최소화 할 수 있기 때문이다.)\n\n참고\n\n[Design Pattern] 옵저버 패턴이란\n\n","dateCreated":"2019-06-20T13:32:51+09:00","dateModified":"2020-05-12T20:30:15+09:00","datePublished":"2019-06-20T13:32:51+09:00","description":"","headline":"[Design Pattern] 옵저버 패턴","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"},"publisher":{"@type":"Organization","name":"VictoryWoo","sameAs":["https://github.com/WooVictory","https://www.facebook.com/WooVictory","https://www.linkedin.com/profile/","jhsw0375@gmail.com"],"image":"Victory.jpeg","logo":{"@type":"ImageObject","url":"Victory.jpeg"}},"url":"https://woovictory.github.io/2019/06/20/DesignPattern-Observer/","keywords":"Design Pattern, 디자인 패턴, Observer Pattern, 옵저버 패턴"}</script>
    <meta name="description" content="옵저버 패턴이란  한 객체의 상태 변화에 따라 다른 객체의 상태도 연동되도록 하고 자동으로 내용이 갱신되는 방식으로 일대다 객체 의존 관계를 구성하는 패턴이다. 데이터의 변경이 발생했을 경우 상대 클래스나 객체에 의존하지 않으면서 데이터 변경을 통보하고자 할 때 유용하다.  ex) 새로운 파일이 추가되거나 기존 파일이 삭제되었을 때 탐색기는 다른 탐색기에게">
<meta name="keywords" content="Design Pattern,디자인 패턴,Observer Pattern,옵저버 패턴">
<meta property="og:type" content="blog">
<meta property="og:title" content="[Design Pattern] 옵저버 패턴">
<meta property="og:url" content="https://woovictory.github.io/2019/06/20/DesignPattern-Observer/index.html">
<meta property="og:site_name" content="VictoryWoo">
<meta property="og:description" content="옵저버 패턴이란  한 객체의 상태 변화에 따라 다른 객체의 상태도 연동되도록 하고 자동으로 내용이 갱신되는 방식으로 일대다 객체 의존 관계를 구성하는 패턴이다. 데이터의 변경이 발생했을 경우 상대 클래스나 객체에 의존하지 않으면서 데이터 변경을 통보하고자 할 때 유용하다.  ex) 새로운 파일이 추가되거나 기존 파일이 삭제되었을 때 탐색기는 다른 탐색기에게">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://woovictory.github.io/img/observer_pattern.png">
<meta property="og:image" content="https://woovictory.github.io/img/observer_example.png">
<meta property="og:image" content="https://woovictory.github.io/img/observer_problem.png">
<meta property="og:image" content="https://woovictory.github.io/img/observer_solution.png">
<meta property="og:image" content="https://woovictory.github.io/img/observer_solution2.png">
<meta property="og:updated_time" content="2020-05-12T11:30:15.896Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[Design Pattern] 옵저버 패턴">
<meta name="twitter:description" content="옵저버 패턴이란  한 객체의 상태 변화에 따라 다른 객체의 상태도 연동되도록 하고 자동으로 내용이 갱신되는 방식으로 일대다 객체 의존 관계를 구성하는 패턴이다. 데이터의 변경이 발생했을 경우 상대 클래스나 객체에 의존하지 않으면서 데이터 변경을 통보하고자 할 때 유용하다.  ex) 새로운 파일이 추가되거나 기존 파일이 삭제되었을 때 탐색기는 다른 탐색기에게">
<meta name="twitter:image" content="https://woovictory.github.io/img/observer_pattern.png">
    
    
        
    
    
        <meta property="og:image" content="https://woovictory.github.io/assets/images/Victory.jpeg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125410253-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-125410253-1');
    </script>


    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/ "
            aria-label=""
        >
            VictoryWoo
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/Victory.jpeg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/Victory.jpeg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">VictoryWoo</h4>
                
                    <h5 class="sidebar-profile-bio"><p>기록을 통해 사람들과 공유하는 것을 좋아합니다.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/WooVictory"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/WooVictory"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/jhsw0375@gmail.com"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            [Design Pattern] 옵저버 패턴
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-06-20T13:32:51+09:00">
	
		    Jun 20, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Design-Pattern/">Design Pattern</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="옵저버-패턴이란">옵저버 패턴이란</h2>
<ul>
<li>한 객체의 상태 변화에 따라 다른 객체의 상태도 연동되도록 하고 자동으로 내용이 갱신되는 방식으로 <strong>일대다 객체 의존 관계</strong>를 구성하는 패턴이다.</li>
<li>데이터의 변경이 발생했을 경우 <strong>상대 클래스나 객체에 의존하지 않으면서 데이터 변경을 통보하고자 할 때 유용</strong>하다.
<ul>
<li>ex) 새로운 파일이 추가되거나 기존 파일이 삭제되었을 때 탐색기는 다른 탐색기에게 즉시 변경을 통보해야 한다.</li>
<li>ex) 차량 연료량 클래스는 연료량이 부족한 경우 연료량에 관심을 가지는 구체적인 클래스에 직접 의존하지 않는 방식으로 연료량 변화를 통보해야 한다.</li>
<li>‘행위 패턴’ 중 하나</li>
</ul>
</li>
</ul>
<img src="/img/observer_pattern.png" width="700" height="200">
<ul>
<li>옵저버 패턴은 통보 대상 객체의 관리를 Subject 클래스와 Observer 인터페이스로 일반화한다.
<ul>
<li>이를 통해 데이터 변경을 통보하는 클래스는 통보 대상 클래스나 객체에 대한 의존성을 없앨 수 있다.</li>
<li>결과적으로 통보 대상 클래스나 대상 객체의 변경에도 <strong>통보하는 클래스</strong>(ConcreteSubject)를 수정없이 그대로 사용할 수 있다.</li>
<li>대부분 상태를 저장하고 있는 주제 인터페이스를 구현한 하나의 <strong>주제 객체</strong>와 주제 객체에 의존하고 있는 옵저버 인터페이스를 구현한 여러 개의 <strong>옵저버 객체</strong>가 있는 디자인을 바탕으로 한다. 결국, 위와 같은 의미이다.</li>
</ul>
</li>
</ul>
<p><strong>역할이 수행하는 작업</strong></p>
<ul>
<li><code>Observer</code>
<ul>
<li>데이터의 변경을 통보 받는 인터페이스</li>
<li>즉, Subject에서는 Observer 인터페이스의 update 메소드를 호출함으로써 ConcreteSubject의 데이터 변경을 ConcreteObserver에게 통보한다.</li>
</ul>
</li>
<li><code>Subject</code>
<ul>
<li>ConcreteObserver 객체를 관리하는 요소</li>
<li>Observer 인터페이스를 참조해서 ConcreteObserver를 관리하므로 ConcreteObserver의 변화에 독립적일 수 있다.</li>
</ul>
</li>
<li><code>ConcreteSubject</code>
<ul>
<li>변경 관리 대상이 되는 데이터가 있는 클래스(<code>통보하는 클래스</code>)</li>
<li>데이터 변경을 위한 setState 메소드가 있다.</li>
<li>setState 메소드에서는 자신의 데이터인 subjectState를 변경하고 Subject의 nofityObservers 메소드를 호출해서 ConcreteObserver 객체에 변경을 통보한다.</li>
</ul>
</li>
<li><code>ConcreteObserver</code>
<ul>
<li>ConcreteSubject의 변경을 통보 받는 클래스</li>
<li>Observer 인터페이스의 update 메소드를 구현함으로써 변경을 통보받는다.</li>
<li>변경된 데이터는 ConcreteSubject의 getState 메소드를 호출함으로써 변경을 조회한다.</li>
</ul>
</li>
</ul>
<h2 id="예시">예시</h2>
<img src="/img/observer_example.png" width="700" height="200">
- 여러 가지 방식으로 성적을 출력해보기.
- 입력된 성적 값을 출력하는 프로그램
<p><strong>ScoreRecord 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 입력된 점수를 저장하는 클래스</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> DataSheetView dataSheetView;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSheetView</span><span class="params">(DataSheetView dataSheetView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataSheetView = dataSheetView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 새로운 점수를 추가하면 출력하는 것에 변화를 통보(update())하여 출력하는 부분 갱신.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score); <span class="comment">// scores 목록에 주어진 점수를 추가한다.</span></span><br><span class="line">        dataSheetView.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 출력하는 부분에서 변화된 내용을 얻어감.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>DataSheetView 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. 출력 형태 : 목록 형태로 출력하는 클래스</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSheetView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ScoreRecord scoreRecord;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> viewCount;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataSheetView</span><span class="params">(ScoreRecord scoreRecord, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.scoreRecord = scoreRecord;</span><br><span class="line">        <span class="keyword">this</span>.viewCount = viewCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수의 변경을 통보 받는다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; record = scoreRecord.getScoreRecord(); <span class="comment">// 점수를 조회한다.</span></span><br><span class="line">        displayScores(record, viewCount); <span class="comment">// 조회된 점수를 viewCount 만큼만 출력한다.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수를 출력한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">displayScores</span><span class="params">(List&lt;Integer&gt; record, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"List of "</span> + viewCount + <span class="string">" entries: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; viewCount &amp;&amp; i &lt; record.size(); i++) &#123;</span><br><span class="line">            System.out.println(record.get(i) + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ObserverClient 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ScoreRecord scoreRecord = <span class="keyword">new</span> ScoreRecord();</span><br><span class="line">        <span class="comment">// 3개까지의 점수만 출력.</span></span><br><span class="line">        DataSheetView dataSheetView = <span class="keyword">new</span> DataSheetView(scoreRecord, <span class="number">3</span>);</span><br><span class="line">        scoreRecord.setDataSheetView(dataSheetView);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> score = i * <span class="number">10</span>;</span><br><span class="line">            System.out.println(<span class="string">"Adding : "</span> + score);</span><br><span class="line">            <span class="comment">// 10, 20, 30, 40, 50을 추가한다.</span></span><br><span class="line">            <span class="comment">// 추가할 때마다 최대 3개의 점수만 출력한다.</span></span><br><span class="line">            scoreRecord.addScore(score);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ScoreRecord 클래스의 addScore() 메소드가 호출되면 ScoreRecord 클래스는 자신의 필드인 scores 객체에 점수를 추가한다.
<ul>
<li>그리고 DataSheetView 클래스의 update() 메소드를 호출함으로써 성적을 출력하도록 요청한다.</li>
</ul>
</li>
<li>DataSheetView 클래스는 ScoreRecord 클래스의 getScoreRecord() 메소드를 호출해 출력할 점수를 구한다.
<ul>
<li>이때 DataSheetView 클래스의 update() 메소드에서는 구한 점수 중에서 명시된 개수만큼(viewCount)의 점수만 출력한다.</li>
</ul>
</li>
</ul>
<h2 id="문제점">문제점</h2>
<ol>
<li>성적을 다른 형태로 출력하는 경우</li>
</ol>
<ul>
<li>성적을 목록으로 출력하지 않고 성적의 최소, 최대 값만 출력하려면?</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> MinMaxView minMaxView;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMinMaxView</span><span class="params">(MinMaxView minMaxView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.minMaxView = minMaxView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score);</span><br><span class="line">        minMaxView.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>점수 변경에 대한 통보 대상 클래스가 다른 대상 클래스(DataSheetView -&gt; MinMaxView)로 바뀌면 기존 코드(ScoredRecord 클래스)의 내용을 수정해야 하므로 OCP에 위배된다.</p>
<ol start="2">
<li>동시 혹은 순차적으로 성적을 출력하는 경우</li>
</ol>
<ul>
<li>성적이 입력되었을 때 최대 3개 목록, 최대 5개 목록, 최소/최대 값을 동시에 출력하려면?</li>
<li>처음에는 목록으로 출력하고 나중에는 최소/최대 값을 출력하려면?</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> MinMaxView minMaxView;</span><br><span class="line">    <span class="keyword">private</span> DataSheetView dataSheetView;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMinMaxView</span><span class="params">(MinMaxView minMaxView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.minMaxView = minMaxView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSheetView</span><span class="params">(DataSheetView dataSheetView)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataSheetView = dataSheetView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 새로운 점수를 추가하면 출력하는 것에 변화를 통보(update())하여 출력하는 부분을 갱신한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score);</span><br><span class="line">        dataSheetView.update(); <span class="comment">// scores가 변경됨을 통보한다.</span></span><br><span class="line">        minMaxView.update(); <span class="comment">// scores가 변경됨을 통보한다.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이 경우에도 점수 변경에 대한 통보 대상 클래스가 다른 클래스로 바뀌면(DataSheetView -&gt; MinMaxView) 기존 코드의 내용을 수정해야 하므로 <strong>OCP에 위배된다.</strong></p>
<p>즉, 성적 변경을 새로운 클래스에 통보할 때마다 ScoreRecord 클래스의 코드를 수정해야 하므로 번거롭고 재사용하기가 어렵다.</p>
<img src="/img/observer_problem.png" width="700" height="200">
<p>위의 그림처럼 양방향의 의존 관계를 가지고 있기 때문에 통보 대상 클래스가 변경되면 ScoreRecord 클래스도 수정해야 한다. 따라서 우리는 이 문제를 해결해야 한다.</p>
<h2 id="해결책">해결책</h2>
<p>문제를 해결하기 위해서는 <code>공통 기능을 상위 클래스 및 인터페이스로 일반화</code>하고 이를 활용하여 통보하는 클래스를 구현해야 한다.</p>
<ul>
<li>즉, ScoreRecord 클래스에서 변화되는 부분을 식별하고 이를 일반화시켜야 한다.</li>
<li>이를 통해 성적 통보 대상이 변경되더라도 ScoreRecord 클래스를 그대로 재사용할 수 있다.</li>
<li>ScoreRecord 클래스에서 하는 작업
<ul>
<li>통보 대상인 객체를 참조하는 것을 관리(추가/제거) -&gt; <strong>Subject</strong> 클래스로 일반화</li>
<li>addScore 메소드 : 각 통보 대상인 객체의 update() 메소드를 호출 -&gt; <strong>Observer</strong> 인터페이스로 일반화</li>
</ul>
</li>
</ul>
<img src="/img/observer_solution.png" width="700" height="200">
<ol>
<li>ScoreRecord 클래스의 addScore(상태 변경) 메소드 호출
<ul>
<li>자신의 성적 값을 저장한다.</li>
<li>상태가 변경될 때마다 Subject 클래스의 notifyObservers() 메소드를 호출한다.</li>
</ul>
</li>
<li>Subject 클래스의 notifyObservers() 메소드 호출
<ul>
<li>Observer 인터페이스를 통해 성적 변경을 통보한다.</li>
<li>DataSheetView 클래스의 update() 메소드 호출</li>
<li>MinMaxView 클래스의 update() 메소드 호출</li>
</ul>
</li>
</ol>
<h2 id="개선-시킨-후의-코드">개선 시킨 후의 코드</h2>
<p><strong>Observer 인터페이스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 데이터 변경을 통보했을 때 처리하는 메소드</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Subject 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 추상화된 변경 관심 데이터</span></span><br><span class="line"><span class="comment"> * 즉, 데이터에 공통적으로 들어가야 하는 메소드들 -&gt; 일반화</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 추상화된 통보 대상 목록.</span></span><br><span class="line">    <span class="comment">// 즉, 출력 형태에 대한 Observer</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; observers = <span class="keyword">new</span> ArrayList&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 통보 대상 추가.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observers.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 통보 대상 제거.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observers.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 각 통보 대상에게 변경을 통보한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObservers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer : observers) &#123;</span><br><span class="line">            observer.update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ScoreRecord 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 구체적인 감시 대상 데이터</span></span><br><span class="line"><span class="comment"> * 출력 형태 2개를 가질 때</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> <span class="keyword">extends</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 새로운 점수를 추가. -&gt; 상태 변경</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score); <span class="comment">// scores 목록에 주어진 점수를 추가한다.</span></span><br><span class="line">        notifyObservers(); <span class="comment">// scores 가 변경됨을 각 통보 대상에게 통보한다.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>DataSheetView 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. 출력 형태 : 목록 형태로 출력하는 클래스</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSheetView</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ScoreRecord scoreRecord;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> viewCount;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataSheetView</span><span class="params">(ScoreRecord scoreRecord, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.scoreRecord = scoreRecord;</span><br><span class="line">        <span class="keyword">this</span>.viewCount = viewCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수를 출력한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">displayScores</span><span class="params">(List&lt;Integer&gt; record, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"List of "</span> + viewCount + <span class="string">" entries: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; viewCount &amp;&amp; i &lt; record.size(); i++) &#123;</span><br><span class="line">            System.out.println(record.get(i) + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//System.out.println();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수의 변경을 통보 받는다.</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; record = scoreRecord.getScoreRecord(); <span class="comment">// 점수를 조회한다.</span></span><br><span class="line">        displayScores(record, viewCount); <span class="comment">// 조회된 점수를 viewCount 만큼만 출력한다.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>MinMaxView 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2. 출력 형태 : 최대, 최소 값만을 출력한다.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MinMaxView</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ScoreRecord scoreRecord;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinMaxView</span><span class="params">(ScoreRecord scoreRecord)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.scoreRecord = scoreRecord;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">displayScores</span><span class="params">(List&lt;Integer&gt; record)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> min = Collections.min(record);</span><br><span class="line">        <span class="keyword">int</span> max = Collections.max(record);</span><br><span class="line">        System.out.println(<span class="string">"Min : "</span> + min + <span class="string">", Max : "</span> + max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; record = scoreRecord.getScoreRecord();</span><br><span class="line">        displayScores(record);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ObserverClient 클래스에서의 사용</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ScoreRecord scoreRecord = <span class="keyword">new</span> ScoreRecord();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3개까지만 데이터를 출력한다.</span></span><br><span class="line">        DataSheetView dataSheetView = <span class="keyword">new</span> DataSheetView(scoreRecord, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">// 최대, 최소 값만 출력한다.</span></span><br><span class="line">        MinMaxView minMaxView = <span class="keyword">new</span> MinMaxView(scoreRecord);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 각 통보 대상 클래스를 Observer 로 추가한다.</span></span><br><span class="line">        scoreRecord.attach(dataSheetView);</span><br><span class="line">        scoreRecord.attach(minMaxView);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> score = i * <span class="number">10</span>;</span><br><span class="line">            System.out.println();</span><br><span class="line">            System.out.println(<span class="string">"Adding : "</span> + score);</span><br><span class="line">            scoreRecord.addScore(score);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Observer : 추상화된 통보 대상</li>
<li>DataSheetView, MinMaxView : Observer를 구현함으로써 구체적인 통보 대상이 된다.</li>
<li>Subject : 성적 변경에 관심이 있는 대상 객체들을 관리한다.</li>
<li>ScoreRecord : Subject를 상속받음으로써 구체적인 통보 대상을 직접 참조하지 않아도 된다. notifyObservers()를 호출함으로써 Subject 클래스에서 각 통보 대상들에게 변경 사항을 통보한다.</li>
<li>이렇게 Observer 패턴을 이용하면 ScoreRecord 클래스의 코드를 변경하지 않고도 새로운 관심 클래스 및 객체를 추가/제거하는 것이 가능해진다.</li>
</ul>
<h2 id="느낀-점">느낀 점</h2>
<p>결국, 처음에는 양방향으로 참조를 해서 강한 의존성을 갖고 있었다. 하지만, Observer 패턴을 적용함으로써 의존성을 약하게 결합하도록 하고 양방향 참조를 하지 않도록 함으로써 디자인 원칙을 위배하지 않으면서 데이터 변경을 적절하게 통보할 수 있게 되었다.</p>
<p>이처럼 느슨하게 결합하는 디자인을 사용하면 변경 사항이 생겨도 무난하게 처리할 수 있는 유연한 객체지향 시스템을 구축할 수 있다. (객체 사이의 상호 의존성을 최소화 할 수 있기 때문이다.)</p>
<img src="/img/observer_solution2.png" width="700" height="200">
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://gmlwjd9405.github.io/2018/07/08/observer-pattern.html" target="_blank" rel="noopener">[Design Pattern] 옵저버 패턴이란</a></li>
</ul>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Design-Pattern/">Design Pattern</a> <a class="tag tag--primary tag--small t-link" href="/tags/Observer-Pattern/">Observer Pattern</a> <a class="tag tag--primary tag--small t-link" href="/tags/디자인-패턴/">디자인 패턴</a> <a class="tag tag--primary tag--small t-link" href="/tags/옵저버-패턴/">옵저버 패턴</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/06/24/Android-NestedScrollview-issue/"
                    data-tooltip="[Android] NestedScrollView Issue"
                    aria-label="PREVIOUS: [Android] NestedScrollView Issue"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/06/19/RxJava-Chap05-Scheduler/"
                    data-tooltip="[RxJava] Chap05. 스케줄러"
                    aria-label="NEXT: [RxJava] Chap05. 스케줄러"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 VictoryWoo. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/06/24/Android-NestedScrollview-issue/"
                    data-tooltip="[Android] NestedScrollView Issue"
                    aria-label="PREVIOUS: [Android] NestedScrollView Issue"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2019/06/19/RxJava-Chap05-Scheduler/"
                    data-tooltip="[RxJava] Chap05. 스케줄러"
                    aria-label="NEXT: [RxJava] Chap05. 스케줄러"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="2">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://woovictory.github.io/2019/06/20/DesignPattern-Observer/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/Victory.jpeg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">VictoryWoo</h4>
        
            <div id="about-card-bio"><p>기록을 통해 사람들과 공유하는 것을 좋아합니다.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Android Developer</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://woovictory.github.io/2019/06/20/DesignPattern-Observer/';
              
            this.page.identifier = '2019/06/20/DesignPattern-Observer/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'https-woovictory-github-io';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
