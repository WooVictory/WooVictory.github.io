
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="VictoryWoo">
    <title>VictoryWoo</title>
    <meta name="author" content="VictoryWoo">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"Website","@id":"https://woovictory.github.io","author":{"@type":"Person","name":"VictoryWoo","sameAs":["https://github.com/WooVictory","https://www.facebook.com/WooVictory","https://www.linkedin.com/profile/","jhsw0375@gmail.com"],"image":"Victory.jpeg"},"name":"VictoryWoo","description":"","url":"https://woovictory.github.io"}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="VictoryWoo">
<meta property="og:url" content="https://woovictory.github.io/archives/7/index.html">
<meta property="og:site_name" content="VictoryWoo">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="VictoryWoo">
    
    
        
    
    
        <meta property="og:image" content="https://woovictory.github.io/assets/images/Victory.jpeg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125410253-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-125410253-1');
    </script>


    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/ "
            aria-label=""
        >
            VictoryWoo
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/Victory.jpeg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/Victory.jpeg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">VictoryWoo</h4>
                
                    <h5 class="sidebar-profile-bio"><p>기록을 통해 사람들과 공유하는 것을 좋아합니다.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/WooVictory"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.facebook.com/WooVictory"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/jhsw0375@gmail.com"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/07/05/Android-RecyclerView-ClickListener-kotlin/"
                            aria-label=": [Android] RecyclerView ClickListener"
                        >
                            [Android] RecyclerView ClickListener
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-07-05T12:34:18+09:00">
	
		    Jul 05, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>이번에는 Android에서 RecyclerView를 사용할 때, 각 아이템의 ClickListener를 다는 방법에 대해서 설명하려고 한다. 여러가지 방법이 있겠지만, 이번에는 Kotlin의 특징 중 하나인 <strong>함수를 매개변수로 넘길 수 있다는 특징</strong>을 사용하려고 한다.</p>
<p>필자가 진행 중인 프로젝트의 일부 코드를 기반으로 설명할 예정이다.</p>
<h2 id="구현">구현</h2>
<ol>
<li>먼저, MainFragment에서 RecyclerView를 사용할 것이다. 그리고 RecyclerView의 각 아이템을 눌렀을 때 어떤 동작을 할 것인지를 미리 정의해둔다.</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">startToDetailActivity</span><span class="params">(id: <span class="type">Int</span>, message: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> intent = Intent(context, MissionDetailActivity::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line">        intent.putExtra(<span class="string">"id"</span>, id)</span><br><span class="line">        intent.putExtra(<span class="string">"completeMessage"</span>, message)</span><br><span class="line">        intent.putExtra(<span class="string">"main"</span>,<span class="string">"main"</span>)</span><br><span class="line">        startActivity(intent)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>Int 타입인 id와 String 타입인 message를 매개변수로 받는 함수이다. 이 함수는 id, message를 가지고 MissionDetailActivity로 이동하는 함수이다.</p>
<ol start="2">
<li>이제는 이 함수를 RecyclerView에서 사용될 Adapter에 매개변수로 넘기는 과정이 필요하다. 이 과정은 두 단계로 나눠보도록 하겠다.</li>
</ol>
<ul>
<li>Adapter에서 함수를 인자로 받을 수 있도록 수정.</li>
<li>MainFragment에서 Adapter 객체를 만들 때 위에서 만든 함수를 전달한다.</li>
</ul>
<p>Adapter에서 함수를 인자로 받을 수 있도록 수정해보도록 하겠다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainMissionAdapter</span></span>(<span class="keyword">private</span> <span class="keyword">var</span> onMainMissionItemClick: (<span class="built_in">Int</span>, String) -&gt; <span class="built_in">Unit</span>) :</span><br><span class="line">    RecyclerView.Adapter&lt;MainMissionViewHolder&gt;() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> itemsMock = ArrayList&lt;MissionFeedResponse&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: MainMissionViewHolder &#123;</span><br><span class="line">        <span class="keyword">val</span> binding = ItemListMainMissionBinding.inflate(</span><br><span class="line">            LayoutInflater.from(parent.context)</span><br><span class="line">            , parent, <span class="literal">false</span></span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> MainMissionViewHolder(binding, onMainMissionItemClick)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 생략.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MainMissionAdapter의 기본 생성자를 호출하면서 <code>(Int, String) -&gt; Unit</code>을 확인할 수 있다. 이는 Int, String을 인자로 받고 반환값이 없는 함수를 의미한다. 따라서 Int, String을 인자로 받고 반환값이 없는 함수를 매개변수를 받겠다는 의미이다.</p>
<p>그리고 <strong>onCreateViewHodler</strong>에서 <strong>MainMissionViewHolder</strong>에 매개변수로 받은 <code>onMainMissionItemClick</code> 함수를 넘기고 있다. ViewHolder는 위의 남은 단계가 끝나고 살펴볼 예정이다.</p>
<p>그러면 MainFragment에서 함수를 전달해보도록 하자. 함수를 전달할 때는 람다식을 사용할 수 있다. 이유는 익명 함수이기 때문에 람다식을 이용해서 가독성을 높이고 쉽게 처리할 수 있기 때문이다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mainMissionAdapter = MainMissionAdapter &#123; id, message -&gt;</span><br><span class="line">            startToDetailActivity(id, message)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>초기화 하는 코드이다. MainMissionAdapter의 인자로 id, message를 받는 익명함수가 전달되어야 하기 때문에 람다식을 통해서 id, message를 넘겨 받는다. 이는 위에서 구현해놓은 <code>startToDetailActivity()</code> 함수의 매개변수로 넘겨줘야 한다.</p>
<p>이것은 실제로 값을 받는 코드가 아니다. 이렇게 값을 받을 것이다라고 선언만 해놓은 것이지 아직 코드가 실행되지 않는다.<br>
어떻게 보면 <strong>startToDetailActivity</strong> 함수를 Adapter에 넘기는 것이다. 이 함수는 위치는 MainFragment에 존재하는 것이고 이 함수의 호출을 대신하기 위해서 함수를 넘기는 것이다.</p>
<p>따라서 함수를 넘긴다는 것의 의미는 실제로 이 함수를 넘기는 것이 아니라 원하는 값을 얻어 이 함수에 담아서 호출하기 위함이다. 그래서 Adapter에서 ViewHolder로 넘기면 ViewHolder에서 <strong>onMainMissionItemClick</strong> 이라는 익명 함수를 받는다. 코드를 먼저 보도록 하자.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainMissionViewHolder</span></span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> binding: ItemListMainMissionBinding</span><br><span class="line">    , <span class="keyword">private</span> <span class="keyword">val</span> onMainMissionItemClick: (<span class="built_in">Int</span>, String) -&gt; <span class="built_in">Unit</span></span><br><span class="line">) : RecyclerView.ViewHolder(binding.root) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">onBind</span><span class="params">(item: <span class="type">MissionFeedResponse</span>)</span></span> &#123;</span><br><span class="line">        binding.item = item</span><br><span class="line">        binding.executePendingBindings()</span><br><span class="line"></span><br><span class="line">        binding.itemMainImage.setOnClickListener &#123;</span><br><span class="line">            onMainMissionItemClick.invoke(item.mission.id, item.mission.category.completeMessage)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ViewHolder에서 필자가 원하는 아이템에 <strong>setOnClickListener</strong>를 통해서 클릭 리스너를 달아준다. 그리고 그 안에서 <code>onMainMissionItemClick.invoke()</code>를 호출함으로써 넘겨받은 함수를 대신 호출할 수 있도록 해준다. <strong>invoke()</strong> 함수가 함수를 대신 호출하는 의미를 가진듯 하다.</p>
<p>그래서 여기서 호출하게 되면 MainFragment에서 정의했던 startToDetailActivity() 함수가 호출되고 원하는 동작을 할 수 있게 된다.</p>
<p>내가 원하는 값을 인자로 받는 부분은 ViewHolder에서 이루어지게 되고 실제 함수는 MainFragment에 존재한다. 그리고 호출도 이 함수를 호출하게 되는 것이다.</p>
<p>설명을 두서없이 하였다. 다음에 Kotlin의 사용자 정의 get(), set()을 통해 변경된 코드로 다시 한번 설명하도록 하겠다. 그 때는 더 깔끔하게 글을 쓰도록 할 예정이다. 마지막으로 이 글을 쓴 목적은 코틀린스럽게 코드를 작성하고자 하는 사람들이 영어로 된 자료말고 이 자료를 통해서 더 쉽게 해당 지식을 얻어갔으면 하는 바램에서 작성하게 되었다.</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/07/05/Android-RecyclerView-ClickListener-kotlin/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/07/04/Android-EditTextFunction/"
                            aria-label=": [Android] EditText 유용한 기능"
                        >
                            [Android] EditText 유용한 기능
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-07-04T15:56:02+09:00">
	
		    Jul 04, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>안드로이드에서 EditText는 거의 필수적인 존재라고 봐도 무방할 것 같다. 자주 사용하지만, 매번 필요한 기능을 검색해보기 때문에 유용한 기능들을 정리하려고 포스팅하게 되었다.</p>
<h2 id="기능">기능</h2>
<ul>
<li><code>maxLength</code> : EditText에 작성할 수 있는 최대 길이를 지정한다.</li>
<li><code>singleLine</code> : 이 기능은 true/false로 설정할 수 있으며, false로 설정하게 되면 EditText의 오른쪽 면에 닿으면 줄바꿈이 된다.</li>
<li><code>scrollHorizontally</code> : 이 기능도 마찬가지로 true/false로 설정할 수 있으며, false로 설정하게 되면 EditText의 길이가 오른쪽으로 길어져도 좌우 스크롤이 안된다. 필자는 <strong>singleLine</strong>과 <strong>scrollHorizontally</strong> 속성을 함께 사용하였다.</li>
<li><code>inputType</code> : 키보드의 형태를 지정할 수 있다. 숫자만으로 구성된 키보드를 띄울 수도 있고, e-mail 입력을 할 수 있도록 그에 맞는 키보드를 띄울 수 있다. 공식 문서를 참고하면 잘 정리되어있다.</li>
<li><code>imeOptions</code> : 키보드의 완료 버튼을 지정할 수 있다. 아무 값도 지정하지 않았다면 줄바꿈이 되어 있을 것이다. 필자는 완료를 위해서 <strong>actionDone</strong>으로 지정했다.</li>
<li><code>style</code> : EditText의 커서 색상이나 백그라운드 등을 바꾸고 싶다면 style을 작성해서 EditText에 지정해주면 된다.</li>
</ul>
<p>추가적으로 생각이 나는 부분은 이 포스팅에 계속해서 올릴 예정이다.</p>
<p><strong>[2020.02.19 내용 추가]</strong></p>
<p>이번에 추가하는 부분은 함수라기 보다는 개발하면서 알게 된 방법 중 하나이다.<br>
정말 간단하고, 읽는데 1분도 안걸린다.</p>
<p>어떤 글에 대해 <code>수정</code> 버튼을 누르기 전에는 글을 수정할 수 없다. 하지만, 어떤 액션을 했을 경우, 글을 수정할 수 있도록 하기 위해서 EditText의 <strong>enabled</strong> 속성을 이용했다. 또한, drawable에 파일을 생성해 selector 같이 만들었다.</p>
<ol>
<li>drawable에 파일을 만든다</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">"@android:color/holo_orange_dark"</span> <span class="attr">android:state_enabled</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">"@android:color/black"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>EditText의 textColor에 drawable 파일을 연결한다.</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/et_title"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"50dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@android:color/white"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:enabled</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:gravity</span>=<span class="string">"center_vertical"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:hint</span>=<span class="string">"@string/label_title"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingStart</span>=<span class="string">"@dimen/space_16"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:paddingEnd</span>=<span class="string">"@dimen/space_8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@&#123;vm.memo.title&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textColor</span>=<span class="string">"@drawable/selector_et"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">"@id/toolbar"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>[2020.03.30 추가]</strong></p>
<h2 id="자동-개행하기">자동 개행하기</h2>
<p>필자는 EditText를 사용해 글을 입력 받는데, 오른쪽 면에 닿았을 때 자동 개행이 되기를 원했다. 그래서 <code>android:scrollHorizontally=&quot;false&quot;</code>를 설정하고 <code>android:inputType=&quot;text&quot;</code>로 설정했었다.</p>
<p>하지만, 자동 개행은 적용되지 않았다. 구글링을 해 본 결과 왜 되지 않는가에 대해서는 나오지 않았다. 필자가 생각하기로는 text로 설정함으로써 scrollHorizontally 속성이 제대로 적용되지 않는 것으로 판단이 되었다.</p>
<p>여기까지가 근거 없는 이유였다. 역시나 구글링을 더 해보니 이유를 생각할 수 있었다. EditText의 inputType 속성에 대해서 검색하고 찾아봤다. 그 중 필자가 사용했던 <code>android:inputType=&quot;text&quot;</code>는 다음과 같은 의미를 갖고 있다.</p>
<ul>
<li><code>android:inputType=&quot;text&quot;</code> : none과 같으나 줄바꿈이 불가능하다.</li>
<li><code>android:inputType=&quot;none&quot;</code> : 다른 특징이 없는 기본 EditText. 입력 폼 안에 줄 바꿈이 가능하다.</li>
</ul>
<p>그렇다. <strong>text</strong> 설정으로 인해서 줄바꿈이 되지 않는다. 때문에 scrollHorizontally 설정을 바꾼다하더라도 자동 개행이 되지 않았던 것이다. 이제 속성의 정확한 의미를 알았기 때문에 inputType 값을 설정하지 않아도 되고 설정해도 된다. 필자는 다음과 같이 설정했다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/et_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"200dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginStart</span>=<span class="string">"@dimen/space_16"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginTop</span>=<span class="string">"@dimen/space_8"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_marginEnd</span>=<span class="string">"@dimen/space_16"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">"@drawable/bg_et_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:gravity</span>=<span class="string">"top|start"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:hint</span>=<span class="string">"@string/hint_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:inputType</span>=<span class="string">"textMultiLine"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:maxHeight</span>=<span class="string">"250dp"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:padding</span>=<span class="string">"@dimen/space_16"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:scrollHorizontally</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">"@&#123;vm.memo.content&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textColor</span>=<span class="string">"@drawable/selector_et"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:theme</span>=<span class="string">"@style/EditTextStyle"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">"@id/et_title"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>[inputType 속성]</strong></p>
<ul>
<li><code>textMultiLine</code> : 입력 폼에 줄 바꿈이 가능하다. 따로 설정하지 않으면 단일 줄의 텍스트로 제한된다.</li>
<li><code>scrollHorizontally</code> : 자동으로 줄이 바뀌고 enter 엔터키를 누르면 다음줄로 이동한다.</li>
</ul>
<p>또한 <a href="https://youeye.tistory.com/119" target="_blank" rel="noopener">쎄씨’s</a>님의 블로그에 inputType에 대해서 정리되어 있으니 가서 확인해보는 것도 좋다. 공식 문서가 사실 더 좋다!</p>
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://m.blog.naver.com/PostView.nhn?blogId=websearch&amp;logNo=220400070845&amp;proxyReferer=https%3A%2F%2Fwww.google.com%2F" target="_blank" rel="noopener">[안드로이드] EditText 의 disable 텍스트 색상 설정하는 방법</a></li>
<li><a href="https://m.blog.naver.com/PostView.nhn?blogId=invister&amp;logNo=40150491344&amp;proxyReferer=https%3A%2F%2Fwww.google.com%2F" target="_blank" rel="noopener">android 안드로이드 edittext 자동 줄바꿈</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/07/04/Android-EditTextFunction/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/26/Android-Dialog-Context/"
                            aria-label=": [Android] Dialog Error?!"
                        >
                            [Android] Dialog Error?!
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-26T23:27:06+09:00">
	
		    Jun 26, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>Android 개발을 함에 있어서 <strong>AlertDialog</strong>를 사용하는 경우를 많이 접해봤을 것이다. 예를 들면, 야놀자 앱을 켰을 때 뜨는 광고가 Dialog의 한 예라고 볼 수 있다. 필자도 이러한 Dialog를 만들어야 하는데, 기본으로 제공하는 것이 아니라 Custom 해야 했다.</p>
<p>그래서 xml로 원하는 뷰를 작성하고 CustomDialog라는 클래스를 만들어 xml을 inflate했다.<br>
그리고 Click이 필요하다면 ClickListener도 설정하면 된다.</p>
<p><strong>CustomDialog.class</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomDialog</span></span>(context: Context) : Dialog(context), View.OnClickListener &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> layout = R.layout.custom_dialog</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(layout)</span><br><span class="line">        init()</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">        dialogOkayButton.setOnClickListener(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">when</span> (v.id) &#123;</span><br><span class="line">            R.id.dialogOkayButton -&gt; &#123;</span><br><span class="line">                dismiss()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>그리고 MyPageFragmet 클래스에서 CustomDialog를 사용하려고 한다.<br>
간단하게 호출하면 된다. 코드를 한번 봐보자.</p>
<p><strong>MyPageFragment.class</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fragmentMyPageDataBinding.myPageMissionSuggest.setOnClickListener &#123;</span><br><span class="line">            toast(requireContext().toString())</span><br><span class="line">            <span class="keyword">val</span> dialog = CustomDialog(activity?.applicationContext)</span><br><span class="line">            dialog.setCanceledOnTouchOutside(<span class="literal">false</span>)</span><br><span class="line">            dialog.show()</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>필자는 DataBinding을 사용하기 때문에 위와 같은 코드를 구성했다. 버튼 클릭 시 Dialog를 띄우는 코드이다. Dialog 클래스는 Context를 필요로 하기 때문에 applicationContext를 넘겼다.<br>
‘그럼 이제 Dialog가 뜨겠지?’ 라고 기대해본다.</p>
<blockquote>
<p>Unable to add window – token null is not for an application</p>
</blockquote>
<p>흠, 이게 무슨 상황인가. 왜 실행이 되지 않는 것일까? 역시 해결책은 구글링이다. 찾아보니 Dialog를 생성할 때 넘겨야 하는 Context는 <code>Activity의 Context</code>를 넘겨야 한다. 나는 지금까지 <code>applicationContext</code>를 넘겼기 때문에 저런 에러를 겪은 것이다.</p>
<p>이유는 Dialog가 Activity에 종속적이기 때문이다. 그래서 applicationContext가 아니라 Activity의 Context를 넘겨야 한다. 아마도 Dialog는 Activity가 떠야 그 위에서 그릴 수 있기 때문일 것이다. Application의 생명주기를 따르지 않고 Activity의 생명주기를 따라서 Dialog가 함께 존재하기 때문이다.</p>
<p>그럼 fragment에서 Activity의 context는 어떻게 얻을 수 있을까?</p>
<p>이에 대한 답변은 자바와 코틀린이 조금 다르다.</p>
<ul>
<li>Java : <code>getActivity()</code> 혹은 <code>getContext()</code>를 통해서 얻을 수 있다.</li>
<li>Kotlin : <code>requireContext()</code> 함수를 통해서 얻을 수 있다.</li>
</ul>
<p>그래서 위의 MyPageFragment.class의 코드를 수정하면 아래와 같다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fragmentMyPageDataBinding.myPageMissionSuggest.setOnClickListener &#123;</span><br><span class="line">            toast(requireContext().toString())</span><br><span class="line">            <span class="keyword">val</span> dialog = CustomDialog(requireContext())</span><br><span class="line">            dialog.setCanceledOnTouchOutside(<span class="literal">false</span>)</span><br><span class="line">            dialog.show()</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>그러면 말끔하게 에러가 해결된 모습을 만나게 될 것이다.</p>
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/2634991/android-1-6-android-view-windowmanagerbadtokenexception-unable-to-add-window" target="_blank" rel="noopener">StackOverflow</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/26/Android-Dialog-Context/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/25/Android-RecyclerView-BottomSpace/"
                            aria-label=": [Android] RecyclerView Bottom padding"
                        >
                            [Android] RecyclerView Bottom padding
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-25T20:30:17+09:00">
	
		    Jun 25, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>Android에서 RecyclerView의 사용은 거의 필수라고 할 수 있다. 왜냐하면 리스트를 보여주는 화면은 대부분의 앱에 존재할 것이기 때문이다. 이번 글은 간단하다. 리싸이클러뷰를 사용하는 사람이라면 글을 읽는데 어려움이 없을 것이다. 사실, 몰라도 볼 수 있다. 그만큼 간단한 글이다.</p>
<h2 id="recyclerview">RecyclerView</h2>
<p>리싸이클러뷰는 리스트 화면을 구성하는데 효율적이다. 이유는 View를 재활용하기 때문이다. 화면을 작성하고 보면 리스트의 제일 하단 공간이 아래와 바짝 붙어있는 경우를 본 적이 있을 것이다. 이를 해결하기 위한 방법은 내가 할 수 있는 것 중에서는 두 가지가 있다.</p>
<ul>
<li>ItemDecoration 클래스를 만들어서 마지막 아이템일 경우 공간을 추가하는 방법</li>
<li>RecyclerView 자체에 padding을 주는 방법</li>
</ul>
<p>첫 번째 방법은 <code>addDecoration</code> 키워드를 가지고 검색해보면 답을 구할 수 있다. 이 방법은 추후에 설명하도록 하겠다. 이것보다 훨씬 간단한 두 번째 방법을 설명하겠다. 두 번째 방법 그대로 padding을 RecyclerView에 추가하면 어떻게 될까??</p>
<p>내가 원하는 것처럼 바닥과 공간이 떨어진다. 하지만, 스크롤이 되는 위치도 그만큼 떨어지게 된다. 즉 RecyclerView를 자식으로 가지는 부모 뷰에 꽉 차지 않는 것이다. 이를 해결하기 위해서는 다음의 한 줄을 추가하면 간단하게 해결된다</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:clipToPadding="false"</span><br></pre></td></tr></table></figure>
<p>공식 문서의 내용을 보면 다음과 같다.</p>
<blockquote>
<p>Defines whether the ViewGroup will clip its children and resize (but not clip) any EdgeEffect to its padding, if padding is not zero. This property is set to true by default.</p>
</blockquote>
<p><strong>해석해보면 패딩이 0이 아닌 경우에는 ViewGroup이 자신의 자식 뷰의 영역을 자르고 EdgeEffect의 크기를 조정(clip)할지 여부를 규정한다. 이 속성은 기본적으로 true로 설정되어 있다.</strong></p>
<p>기본적으로 패딩값이 설정되어 있다면 ViewGroup은 자신의 자식 뷰의 영역을 자르고 EdgeEffect(사용자가 2D 공간에서 콘텐츠 경계를 넘어 스크롤할 때 스크롤 가능한 위젯의 가장자리에서 사용하는 그래픽 효과를 말한다.)의 크기를 조정한다. 이 속성을 false로 설정한다는 것은 EdgeEffect의 크기를 조정하지 않는다. 따라서 스크롤 가능한 위젯의 가장자리에서 사용하는 그래픽 효과는 부모 뷰에 맞도록 설정이 된다는 걸 뜻한다.</p>
<p>그래서 스크롤할 때 부모 뷰에서 떨어지지 않고 내가 원하는 동작을 할 수 있다. 이것은 나의 해석과 생각이 담겨 있다. 그래서 사실이 아닐 수도 있다. 질문이나 틀린 점이 있다면 알려주면 피드백 반영해서 수정하도록 하겠습니다.</p>
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://developer.android.com/reference/android/view/ViewGroup.html#attr_android:clipToPadding" target="_blank" rel="noopener">Android Developer clipToPadding</a></li>
<li><a href="https://developer.android.com/reference/android/widget/EdgeEffect" target="_blank" rel="noopener">Android Developer EdgeEffect</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/25/Android-RecyclerView-BottomSpace/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/24/Android-Progressbar-tip/"
                            aria-label=": [Android] 로딩시 어떻게 할 것인가?"
                        >
                            [Android] 로딩시 어떻게 할 것인가?
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-24T23:37:18+09:00">
	
		    Jun 24, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>안드로이드 개발에서 서버로부터 데이터를 불러올 때, 네트워크 상황이 좋지 않다면 금방 불러올 수 없을 것이다. 시간이 어느 정도 걸린다. 또한, 불러오는 데이터 중 사진, 영상이 많거나 데이터의 양이 많다면 시간이 오래 걸린다.</p>
<p>이처럼 시간이 오래 걸리는 작업을 아무런 동작 없이 그냥 냅두면 사용자는 빈 화면을 보다가 갑자기 나타난 화면에 좋지 않은 경험을 할 것이다. 그래서 이를 해결하기 위한 방법은 내가 생각했을 때는 두가지가 있다.</p>
<ul>
<li>Progress Bar를 이용한 로딩</li>
<li><a href="https://github.com/elye/loaderviewlibrary" target="_blank" rel="noopener">loaderViewLibrary</a>를 사용하는 방법</li>
</ul>
<p>아마도 이 글은 두 Part로 나뉘어서 쓸 것 같다. 이번에는 <code>Progress Bar</code>를 이용한 로딩 방법을 다뤄보고 다음에는 <code>loaderViewLibrary</code>를 이용한 방법을 다룰 예정이다.</p>
<h2 id="progressbar">Progressbar</h2>
<p>사용방법은 정말 간단하다. 그냥 xml에 정의해서 사용하면 된다. 아래 xml 코드를 보자.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ProgressBar</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:id</span>=<span class="string">"@+id/loading"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">android:layout_marginBottom</span>=<span class="string">"8dp"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>이렇게 정의하면 빨간색의 ProgressBar를 볼 수 있다. 원형이 기본 형태인 것 같다. 색상도 빨간색이 기본으로 설정되어 있다. 하지만, 이 빨간색은 여러분이 개발하고 있는 앱의 색상과 맞지 않을 것이다. 그래서 변경하려는 사람이 많다. 필자도 변경하려고 구글링을 좀 해봤다.</p>
<p>여러 방법이 있지만, 가장 단순한 방법은 다음 코드 한 줄을 추가하는 것이다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:indeterminateTint=&quot;@color/fe_fu_main&quot;</span><br></pre></td></tr></table></figure>
<p>이 속성이 무엇인지는 <a href="https://developer.android.com/reference/android/widget/ProgressBar.html#attr_android:indeterminateTint" target="_blank" rel="noopener">Android Developer</a> 문서에 설명되어 있다. 사진을 아래와 같이 첨부했다.</p>
<img src="/img/android_progress_color_change.png" width="700" height="200">
<p>해석해보면 ProgressBar에 적용할 색상이라고 한다. indeterminate가 뭔지 몰랐는데 <strong>불확정의</strong>라는 뜻을 가진다. ProgressBar가 불확정에서 확정으로 되는 동안 로딩하기 위해 쓰이는 것이라 이런 이름을 붙이지 않았을까 추측해본다. (물론 나의 생각!!)</p>
<p>저 속성을 통해서 원하는 색상을 지정하면 사용자가 원하는 색상을 사용할 수 있다. 직접 drawable 파일을 만들어서 커스텀하는 방법도 있는데, 이는 디자인 자체에서 조금 다르면 커스텀해서 사용해도 좋을 것 같다. 다음의 스택 오버플로우 질문을 보면 답변에 두 방식 모두 나와있다. -&gt; <a href="https://stackoverflow.com/questions/5337613/how-to-change-color-in-circular-progress-bar/17785769" target="_blank" rel="noopener">https://stackoverflow.com/questions/5337613/how-to-change-color-in-circular-progress-bar/17785769</a></p>
<h2 id="사용해보기">사용해보기</h2>
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://developer.android.com/reference/android/widget/ProgressBar.html#attr_android:indeterminateTint" target="_blank" rel="noopener">Android Developer</a></li>
<li><a href="https://stackoverflow.com/questions/5337613/how-to-change-color-in-circular-progress-bar/17785769" target="_blank" rel="noopener">https://stackoverflow.com/questions/5337613/how-to-change-color-in-circular-progress-bar/17785769</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/24/Android-Progressbar-tip/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/24/Android-NestedScrollview-issue/"
                            aria-label=": [Android] NestedScrollView Issue"
                        >
                            [Android] NestedScrollView Issue
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-24T17:04:21+09:00">
	
		    Jun 24, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Android/">Android</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>안드로이드 개발을 하다보면 ScrollView 안에 RecyclerView를 넣어야 하는 경우가 생긴다. 이럴 때, <code>NestedScrollView</code>를 사용하면 된다. 이름처럼 중첩된 스크롤뷰라는 뜻이다. 필자는 NestedScrollView를 아주 유용하게 사용한다. 사용하는 상황은 다음과 같다.</p>
<ul>
<li>RecyclerView이 있는데 다른 형태의 뷰가 보여질 때</li>
<li>타이틀이 있고 아래에 리스트 목록이 보일 때</li>
</ul>
<p>두 가지 경우는 거의 비슷하다. 첫 번째 경우는 사실 ViewType을 다르게 하여 RecyclerView를 구성할 수도 있다. 하지만, 이 부분이 조금 번거롭다면 NestedScrollView를 사용하는 것도 하나의 방법이다.</p>
<h2 id="issue">issue</h2>
<p>이제 필자가 겪은 문제를 말하려고 한다. 서론이 길었다. 위에서 두 번째 경우를 구현해야 하는 상황이 있었다. <strong>NestedScrollView는 ScrollView와 마찬가지로 내부에 ViewGroup을 하나만 가질 수 있다.</strong> 그래서 LinearLayout을 두고 그 안에 타이틀을 보여주는 TextView와 리스트를 나타내는 RecyclerView를 두었다.</p>
<p>그런데 경우에 따라서 이 NestedScrollView가 자기 멋대로 밑으로 스크롤이 내려갈 때가 있다. 처음에는 이유를 몰랐다. 그래서 구글링을 해보면서 찾아봤다. 이유는 뷰가 그려지면서 안에 넣어둔 또 다른 ScrollView(즉, 여기서는 RecyclerView)에 포커스가 잡히면서 타이틀이 보이지 않는 것이었다.</p>
<p>그래서 이 포커스를 어떻게 없앨까 찾아보았다. 포커스만 없앤다면 뷰가 그려지면서 RecyclerView에 포커스되는 상황이 없어지고 스크롤이 제멋대로 내려가지 않을테니 말이다. 바로 다음의 한줄만 추가하면 된다.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:descendantFocusability="blocksDescendants"</span><br></pre></td></tr></table></figure>
<p><strong>무슨 속성일까?</strong></p>
<ul>
<li><code>descendantFocusability</code> : <strong>ViewGroup 내에서 포커스를 맞출 때 ViewGroup과 그의 하위 뷰의 관계를 설정한다.</strong> 여기서 하위 뷰란 자식 뷰를 의미한다.</li>
<li><code>blocksDescendants</code> : 해당 뷰 그룹의 하위 뷰가 포커스를 받지 못하게 하는 옵션이다.</li>
</ul>
<p><strong>어디에 정의할까?</strong></p>
<p>ScrollView의 자식 뷰에 설정하면 된다. 스크롤뷰는 자식 뷰를 하나만 가지기 때문에 LinearLayout에 설정하면 된다.</p>
<p><strong>xml 코드</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.core.widget.NestedScrollView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"0dp"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">"@id/achieveAppBar"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:descendantFocusability</span>=<span class="string">"blocksDescendants"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginStart</span>=<span class="string">"@dimen/margin_24dp"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">"@dimen/margin_16dp"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:text</span>=<span class="string">"@string/text_my_page_achieve_list_title"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">style</span>=<span class="string">"@style/SubTitleHeaderStyle"</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:id</span>=<span class="string">"@+id/achieveListRv"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:overScrollMode</span>=<span class="string">"never"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">android:layout_marginTop</span>=<span class="string">"@dimen/margin_24dp"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">androidx.core.widget.NestedScrollView</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="결론">결론</h2>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:descendantFocusability="blocksDescendants"</span><br></pre></td></tr></table></figure>
<p>정리하면, 위의 설정은 NestedScrollView 안의 자식 뷰(하위 뷰)가 포커스를 가져가는 현상을 막아준다. 즉, NestedScrollView 안에 있는 RecyclerView가 포커스를 가져가지 않는다. 따라서 NestedScrollView는 원하던 대로 포커스를 받고 스크롤이 내려가는 현상도 방지할 수 있다.</p>
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://bonoogi.postype.com/post/657336" target="_blank" rel="noopener">NestedScrollView가 보여질 때 제멋대로 스크롤 되는 문제</a></li>
<li><a href="https://stackoverflow.com/questions/34329707/nestedscrollview-scrolls-to-top-on-recyclerview-resized" target="_blank" rel="noopener">NestedScrollView scrolls to top on Recyclerview resized</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/24/Android-NestedScrollview-issue/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/20/DesignPattern-Observer/"
                            aria-label=": [Design Pattern] 옵저버 패턴"
                        >
                            [Design Pattern] 옵저버 패턴
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-20T13:32:51+09:00">
	
		    Jun 20, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Design-Pattern/">Design Pattern</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="옵저버-패턴이란">옵저버 패턴이란</h2>
<ul>
<li>한 객체의 상태 변화에 따라 다른 객체의 상태도 연동되도록 하고 자동으로 내용이 갱신되는 방식으로 <strong>일대다 객체 의존 관계</strong>를 구성하는 패턴이다.</li>
<li>데이터의 변경이 발생했을 경우 <strong>상대 클래스나 객체에 의존하지 않으면서 데이터 변경을 통보하고자 할 때 유용</strong>하다.
<ul>
<li>ex) 새로운 파일이 추가되거나 기존 파일이 삭제되었을 때 탐색기는 다른 탐색기에게 즉시 변경을 통보해야 한다.</li>
<li>ex) 차량 연료량 클래스는 연료량이 부족한 경우 연료량에 관심을 가지는 구체적인 클래스에 직접 의존하지 않는 방식으로 연료량 변화를 통보해야 한다.</li>
<li>‘행위 패턴’ 중 하나</li>
</ul>
</li>
</ul>
<img src="/img/observer_pattern.png" width="700" height="200">
<ul>
<li>옵저버 패턴은 통보 대상 객체의 관리를 Subject 클래스와 Observer 인터페이스로 일반화한다.
<ul>
<li>이를 통해 데이터 변경을 통보하는 클래스는 통보 대상 클래스나 객체에 대한 의존성을 없앨 수 있다.</li>
<li>결과적으로 통보 대상 클래스나 대상 객체의 변경에도 <strong>통보하는 클래스</strong>(ConcreteSubject)를 수정없이 그대로 사용할 수 있다.</li>
<li>대부분 상태를 저장하고 있는 주제 인터페이스를 구현한 하나의 <strong>주제 객체</strong>와 주제 객체에 의존하고 있는 옵저버 인터페이스를 구현한 여러 개의 <strong>옵저버 객체</strong>가 있는 디자인을 바탕으로 한다. 결국, 위와 같은 의미이다.</li>
</ul>
</li>
</ul>
<p><strong>역할이 수행하는 작업</strong></p>
<ul>
<li><code>Observer</code>
<ul>
<li>데이터의 변경을 통보 받는 인터페이스</li>
<li>즉, Subject에서는 Observer 인터페이스의 update 메소드를 호출함으로써 ConcreteSubject의 데이터 변경을 ConcreteObserver에게 통보한다.</li>
</ul>
</li>
<li><code>Subject</code>
<ul>
<li>ConcreteObserver 객체를 관리하는 요소</li>
<li>Observer 인터페이스를 참조해서 ConcreteObserver를 관리하므로 ConcreteObserver의 변화에 독립적일 수 있다.</li>
</ul>
</li>
<li><code>ConcreteSubject</code>
<ul>
<li>변경 관리 대상이 되는 데이터가 있는 클래스(<code>통보하는 클래스</code>)</li>
<li>데이터 변경을 위한 setState 메소드가 있다.</li>
<li>setState 메소드에서는 자신의 데이터인 subjectState를 변경하고 Subject의 nofityObservers 메소드를 호출해서 ConcreteObserver 객체에 변경을 통보한다.</li>
</ul>
</li>
<li><code>ConcreteObserver</code>
<ul>
<li>ConcreteSubject의 변경을 통보 받는 클래스</li>
<li>Observer 인터페이스의 update 메소드를 구현함으로써 변경을 통보받는다.</li>
<li>변경된 데이터는 ConcreteSubject의 getState 메소드를 호출함으로써 변경을 조회한다.</li>
</ul>
</li>
</ul>
<h2 id="예시">예시</h2>
<img src="/img/observer_example.png" width="700" height="200">
- 여러 가지 방식으로 성적을 출력해보기.
- 입력된 성적 값을 출력하는 프로그램
<p><strong>ScoreRecord 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 입력된 점수를 저장하는 클래스</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> DataSheetView dataSheetView;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSheetView</span><span class="params">(DataSheetView dataSheetView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataSheetView = dataSheetView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 새로운 점수를 추가하면 출력하는 것에 변화를 통보(update())하여 출력하는 부분 갱신.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score); <span class="comment">// scores 목록에 주어진 점수를 추가한다.</span></span><br><span class="line">        dataSheetView.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 출력하는 부분에서 변화된 내용을 얻어감.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>DataSheetView 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. 출력 형태 : 목록 형태로 출력하는 클래스</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSheetView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ScoreRecord scoreRecord;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> viewCount;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataSheetView</span><span class="params">(ScoreRecord scoreRecord, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.scoreRecord = scoreRecord;</span><br><span class="line">        <span class="keyword">this</span>.viewCount = viewCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수의 변경을 통보 받는다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; record = scoreRecord.getScoreRecord(); <span class="comment">// 점수를 조회한다.</span></span><br><span class="line">        displayScores(record, viewCount); <span class="comment">// 조회된 점수를 viewCount 만큼만 출력한다.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수를 출력한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">displayScores</span><span class="params">(List&lt;Integer&gt; record, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"List of "</span> + viewCount + <span class="string">" entries: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; viewCount &amp;&amp; i &lt; record.size(); i++) &#123;</span><br><span class="line">            System.out.println(record.get(i) + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ObserverClient 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ScoreRecord scoreRecord = <span class="keyword">new</span> ScoreRecord();</span><br><span class="line">        <span class="comment">// 3개까지의 점수만 출력.</span></span><br><span class="line">        DataSheetView dataSheetView = <span class="keyword">new</span> DataSheetView(scoreRecord, <span class="number">3</span>);</span><br><span class="line">        scoreRecord.setDataSheetView(dataSheetView);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> score = i * <span class="number">10</span>;</span><br><span class="line">            System.out.println(<span class="string">"Adding : "</span> + score);</span><br><span class="line">            <span class="comment">// 10, 20, 30, 40, 50을 추가한다.</span></span><br><span class="line">            <span class="comment">// 추가할 때마다 최대 3개의 점수만 출력한다.</span></span><br><span class="line">            scoreRecord.addScore(score);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ScoreRecord 클래스의 addScore() 메소드가 호출되면 ScoreRecord 클래스는 자신의 필드인 scores 객체에 점수를 추가한다.
<ul>
<li>그리고 DataSheetView 클래스의 update() 메소드를 호출함으로써 성적을 출력하도록 요청한다.</li>
</ul>
</li>
<li>DataSheetView 클래스는 ScoreRecord 클래스의 getScoreRecord() 메소드를 호출해 출력할 점수를 구한다.
<ul>
<li>이때 DataSheetView 클래스의 update() 메소드에서는 구한 점수 중에서 명시된 개수만큼(viewCount)의 점수만 출력한다.</li>
</ul>
</li>
</ul>
<h2 id="문제점">문제점</h2>
<ol>
<li>성적을 다른 형태로 출력하는 경우</li>
</ol>
<ul>
<li>성적을 목록으로 출력하지 않고 성적의 최소, 최대 값만 출력하려면?</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> MinMaxView minMaxView;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMinMaxView</span><span class="params">(MinMaxView minMaxView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.minMaxView = minMaxView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score);</span><br><span class="line">        minMaxView.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>점수 변경에 대한 통보 대상 클래스가 다른 대상 클래스(DataSheetView -&gt; MinMaxView)로 바뀌면 기존 코드(ScoredRecord 클래스)의 내용을 수정해야 하므로 OCP에 위배된다.</p>
<ol start="2">
<li>동시 혹은 순차적으로 성적을 출력하는 경우</li>
</ol>
<ul>
<li>성적이 입력되었을 때 최대 3개 목록, 최대 5개 목록, 최소/최대 값을 동시에 출력하려면?</li>
<li>처음에는 목록으로 출력하고 나중에는 최소/최대 값을 출력하려면?</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> MinMaxView minMaxView;</span><br><span class="line">    <span class="keyword">private</span> DataSheetView dataSheetView;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMinMaxView</span><span class="params">(MinMaxView minMaxView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.minMaxView = minMaxView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDataSheetView</span><span class="params">(DataSheetView dataSheetView)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dataSheetView = dataSheetView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 새로운 점수를 추가하면 출력하는 것에 변화를 통보(update())하여 출력하는 부분을 갱신한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score);</span><br><span class="line">        dataSheetView.update(); <span class="comment">// scores가 변경됨을 통보한다.</span></span><br><span class="line">        minMaxView.update(); <span class="comment">// scores가 변경됨을 통보한다.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이 경우에도 점수 변경에 대한 통보 대상 클래스가 다른 클래스로 바뀌면(DataSheetView -&gt; MinMaxView) 기존 코드의 내용을 수정해야 하므로 <strong>OCP에 위배된다.</strong></p>
<p>즉, 성적 변경을 새로운 클래스에 통보할 때마다 ScoreRecord 클래스의 코드를 수정해야 하므로 번거롭고 재사용하기가 어렵다.</p>
<img src="/img/observer_problem.png" width="700" height="200">
<p>위의 그림처럼 양방향의 의존 관계를 가지고 있기 때문에 통보 대상 클래스가 변경되면 ScoreRecord 클래스도 수정해야 한다. 따라서 우리는 이 문제를 해결해야 한다.</p>
<h2 id="해결책">해결책</h2>
<p>문제를 해결하기 위해서는 <code>공통 기능을 상위 클래스 및 인터페이스로 일반화</code>하고 이를 활용하여 통보하는 클래스를 구현해야 한다.</p>
<ul>
<li>즉, ScoreRecord 클래스에서 변화되는 부분을 식별하고 이를 일반화시켜야 한다.</li>
<li>이를 통해 성적 통보 대상이 변경되더라도 ScoreRecord 클래스를 그대로 재사용할 수 있다.</li>
<li>ScoreRecord 클래스에서 하는 작업
<ul>
<li>통보 대상인 객체를 참조하는 것을 관리(추가/제거) -&gt; <strong>Subject</strong> 클래스로 일반화</li>
<li>addScore 메소드 : 각 통보 대상인 객체의 update() 메소드를 호출 -&gt; <strong>Observer</strong> 인터페이스로 일반화</li>
</ul>
</li>
</ul>
<img src="/img/observer_solution.png" width="700" height="200">
<ol>
<li>ScoreRecord 클래스의 addScore(상태 변경) 메소드 호출
<ul>
<li>자신의 성적 값을 저장한다.</li>
<li>상태가 변경될 때마다 Subject 클래스의 notifyObservers() 메소드를 호출한다.</li>
</ul>
</li>
<li>Subject 클래스의 notifyObservers() 메소드 호출
<ul>
<li>Observer 인터페이스를 통해 성적 변경을 통보한다.</li>
<li>DataSheetView 클래스의 update() 메소드 호출</li>
<li>MinMaxView 클래스의 update() 메소드 호출</li>
</ul>
</li>
</ol>
<h2 id="개선-시킨-후의-코드">개선 시킨 후의 코드</h2>
<p><strong>Observer 인터페이스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 데이터 변경을 통보했을 때 처리하는 메소드</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Subject 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 추상화된 변경 관심 데이터</span></span><br><span class="line"><span class="comment"> * 즉, 데이터에 공통적으로 들어가야 하는 메소드들 -&gt; 일반화</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 추상화된 통보 대상 목록.</span></span><br><span class="line">    <span class="comment">// 즉, 출력 형태에 대한 Observer</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; observers = <span class="keyword">new</span> ArrayList&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 통보 대상 추가.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observers.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 통보 대상 제거.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        observers.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 각 통보 대상에게 변경을 통보한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObservers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer : observers) &#123;</span><br><span class="line">            observer.update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ScoreRecord 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 구체적인 감시 대상 데이터</span></span><br><span class="line"><span class="comment"> * 출력 형태 2개를 가질 때</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScoreRecord</span> <span class="keyword">extends</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; scores = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 새로운 점수를 추가. -&gt; 상태 변경</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>&#123;</span><br><span class="line">        scores.add(score); <span class="comment">// scores 목록에 주어진 점수를 추가한다.</span></span><br><span class="line">        notifyObservers(); <span class="comment">// scores 가 변경됨을 각 통보 대상에게 통보한다.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getScoreRecord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scores;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>DataSheetView 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1. 출력 형태 : 목록 형태로 출력하는 클래스</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSheetView</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ScoreRecord scoreRecord;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> viewCount;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DataSheetView</span><span class="params">(ScoreRecord scoreRecord, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.scoreRecord = scoreRecord;</span><br><span class="line">        <span class="keyword">this</span>.viewCount = viewCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수를 출력한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">displayScores</span><span class="params">(List&lt;Integer&gt; record, <span class="keyword">int</span> viewCount)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"List of "</span> + viewCount + <span class="string">" entries: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; viewCount &amp;&amp; i &lt; record.size(); i++) &#123;</span><br><span class="line">            System.out.println(record.get(i) + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//System.out.println();</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 점수의 변경을 통보 받는다.</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; record = scoreRecord.getScoreRecord(); <span class="comment">// 점수를 조회한다.</span></span><br><span class="line">        displayScores(record, viewCount); <span class="comment">// 조회된 점수를 viewCount 만큼만 출력한다.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>MinMaxView 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2. 출력 형태 : 최대, 최소 값만을 출력한다.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MinMaxView</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ScoreRecord scoreRecord;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinMaxView</span><span class="params">(ScoreRecord scoreRecord)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.scoreRecord = scoreRecord;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">displayScores</span><span class="params">(List&lt;Integer&gt; record)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> min = Collections.min(record);</span><br><span class="line">        <span class="keyword">int</span> max = Collections.max(record);</span><br><span class="line">        System.out.println(<span class="string">"Min : "</span> + min + <span class="string">", Max : "</span> + max);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; record = scoreRecord.getScoreRecord();</span><br><span class="line">        displayScores(record);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ObserverClient 클래스에서의 사용</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObserverClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ScoreRecord scoreRecord = <span class="keyword">new</span> ScoreRecord();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3개까지만 데이터를 출력한다.</span></span><br><span class="line">        DataSheetView dataSheetView = <span class="keyword">new</span> DataSheetView(scoreRecord, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">// 최대, 최소 값만 출력한다.</span></span><br><span class="line">        MinMaxView minMaxView = <span class="keyword">new</span> MinMaxView(scoreRecord);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 각 통보 대상 클래스를 Observer 로 추가한다.</span></span><br><span class="line">        scoreRecord.attach(dataSheetView);</span><br><span class="line">        scoreRecord.attach(minMaxView);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> score = i * <span class="number">10</span>;</span><br><span class="line">            System.out.println();</span><br><span class="line">            System.out.println(<span class="string">"Adding : "</span> + score);</span><br><span class="line">            scoreRecord.addScore(score);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Observer : 추상화된 통보 대상</li>
<li>DataSheetView, MinMaxView : Observer를 구현함으로써 구체적인 통보 대상이 된다.</li>
<li>Subject : 성적 변경에 관심이 있는 대상 객체들을 관리한다.</li>
<li>ScoreRecord : Subject를 상속받음으로써 구체적인 통보 대상을 직접 참조하지 않아도 된다. notifyObservers()를 호출함으로써 Subject 클래스에서 각 통보 대상들에게 변경 사항을 통보한다.</li>
<li>이렇게 Observer 패턴을 이용하면 ScoreRecord 클래스의 코드를 변경하지 않고도 새로운 관심 클래스 및 객체를 추가/제거하는 것이 가능해진다.</li>
</ul>
<h2 id="느낀-점">느낀 점</h2>
<p>결국, 처음에는 양방향으로 참조를 해서 강한 의존성을 갖고 있었다. 하지만, Observer 패턴을 적용함으로써 의존성을 약하게 결합하도록 하고 양방향 참조를 하지 않도록 함으로써 디자인 원칙을 위배하지 않으면서 데이터 변경을 적절하게 통보할 수 있게 되었다.</p>
<p>이처럼 느슨하게 결합하는 디자인을 사용하면 변경 사항이 생겨도 무난하게 처리할 수 있는 유연한 객체지향 시스템을 구축할 수 있다. (객체 사이의 상호 의존성을 최소화 할 수 있기 때문이다.)</p>
<img src="/img/observer_solution2.png" width="700" height="200">
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://gmlwjd9405.github.io/2018/07/08/observer-pattern.html" target="_blank" rel="noopener">[Design Pattern] 옵저버 패턴이란</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/20/DesignPattern-Observer/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/19/RxJava-Chap05-Scheduler/"
                            aria-label=": [RxJava] Chap05. 스케줄러"
                        >
                            [RxJava] Chap05. 스케줄러
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-19T22:22:26+09:00">
	
		    Jun 19, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/RxJava/">RxJava</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>지금까지 공부했던 예제의 공통점은 대부분의 동작이 현재 즉, main 스레드에서 동작한다는 것이었다. 하지만, 실무에서는 요구사항에 맞게 <strong>비동기</strong>로 동작할 수 있도록 이를 바꿔야 한다. 이때 스케줄러를 이용한다.</p>
<p>스케줄러는 스레드를 지정할 수 있게 해준다. 단순히 새로운 스레드를 생성하거나 기존의 Executors를 활용하는 것을 넘어 새로운 방식으로 볼 수 있다. 그동안 어렵게 다뤄야 했단 비동기 프로그래밍이 간결한 코드로 구성될 수 있다.</p>
<img src="/img/rx_flip.png" width="700" height="200">
<p>위의 그림에서 시간 표시줄에 주목해야 한다. 마블 다이어그램을 코드로 표현하면 아래와 같다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlipSample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String[] objs = &#123;<span class="string">"1-T"</span>, <span class="string">"2-S"</span>, <span class="string">"3-P"</span>&#125;;</span><br><span class="line">        Observable&lt;String&gt; source = Observable.fromArray(objs)</span><br><span class="line">                .doOnNext(data -&gt; Log.d(<span class="string">"Original data = "</span> + data))</span><br><span class="line">                .subscribeOn(Schedulers.newThread())</span><br><span class="line">                .observeOn(Schedulers.newThread())</span><br><span class="line">                .map(Shape::flip);</span><br><span class="line"></span><br><span class="line">        source.subscribe(Log::i);</span><br><span class="line">        CommonUtils.sleep(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 결과</span></span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | debug = Original data = <span class="number">1</span>-T</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | debug = Original data = <span class="number">2</span>-S</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | debug = Original data = <span class="number">3</span>-P</span><br><span class="line">RxNewThreadScheduler-<span class="number">2</span> | value = (flipped)<span class="number">1</span>-T</span><br><span class="line">RxNewThreadScheduler-<span class="number">2</span> | value = (flipped)<span class="number">2</span>-S</span><br><span class="line">RxNewThreadScheduler-<span class="number">2</span> | value = (flipped)<span class="number">3</span>-P</span><br></pre></td></tr></table></figure>
<ul>
<li><code>doOnNext()</code> : Observable 에서 onNext 이벤트가 발생하면 실행되며, 여기에서는 원래의 데이터 값을 확인한다.</li>
<li><code>subscribeOn()</code> : 구독자가 Observable 에 subscribe() 함수를 호출하여 구독할 때 실행되는 스레드를 지정한다. -&gt; 해당 작업을 어느 쓰레드에서 실행할 것인가?!</li>
<li><code>observeOn()</code> : Observable 에서 생성한 데이터 흐름이 여기저기 함수를 거치며 처리될 때, 동작이 어느 쓰레드에서 일어나는지 지정할 수 있다. -&gt; 받은 결과를 어느 쓰레드에서 수행할지?!</li>
</ul>
<p>결과를 보면 최초의 데이터 흐름이 발생하는 스레드와 flip() 함수를 거쳐서 구독자에게 전달되는 스레드가 다르다. 보통 우리는 새로운 스레드를 생성하거나 Runnable 혹은 Callable 객체를 생성하는데 우리는 전달한 적이 없다. 단지 <code>subscribeOn()</code>과 <code>observeOn()</code> 함수에 어떤 스케줄러를 지정했을 뿐이다.</p>
<p>이처럼 스케줄러를 활용하는 비동기 프로그래밍의 핵심은 바로 <strong>데이터 흐름이 발생하는 스레드와 처리된 결과를 구독자에게 전달하는 스레드를 분리할 수 있다는 것이다.</strong></p>
<p>위의 코드에서 observeOn() 함수 호출 부분을 제거해보면 어떤 결과가 나올까? 결과는 아래에서 확인할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 결과</span></span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | debug = Original data = <span class="number">1</span>-T</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | value = (flipped)<span class="number">1</span>-T</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | debug = Original data = <span class="number">2</span>-S</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | value = (flipped)<span class="number">2</span>-S</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | debug = Original data = <span class="number">3</span>-P</span><br><span class="line">RxNewThreadScheduler-<span class="number">1</span> | value = (flipped)<span class="number">3</span>-P</span><br></pre></td></tr></table></figure>
<p>observeOn() 함수를 지정하지 않으면 subscribeOn() 함수로 지정한 스레드에서 모든 로직을 실행한다.</p>
<p>지금까지 배운 내용을 간단하게 정리하면 아래와 같다.</p>
<ol>
<li>스케줄러는 RxJava 코드를 어느 스레드에서 실행할지 지정할 수 있다.</li>
<li>subscribeOn() 함수와 observeOn() 함수를 모두 지정하면 Observable에서 데이터 흐름이 발생하는 스레드와 처리된 결과를 구독자에게 발행하는 스레드를 분리할 수 있다.</li>
<li>subscribeOn() 함수만 호출하면 Observable의 모든 흐름이 동일한 스레드에서 실행된다.(observeOn() 함수를 생략했을 경우!)</li>
<li>스케줄러를 별도로 지정하지 않으면 현재(main) 스레드에서 동작을 실행한다.</li>
</ol>
<h2 id="스케줄러의-종류">스케줄러의 종류</h2>
<ul>
<li>특정 스케줄러를 사용하다가 다른 스케줄러로 변경하기 쉽다는 특징을 가지고 있다.</li>
<li>마치 map() 함수를 한 번 더 호출하는 것처럼 새롭게 스케줄러를 추가하거나 기존의 스케줄러를 다른 것으로 교체할 수 있다.</li>
</ul>
<p><strong>1. 뉴 스레드 스케줄러</strong></p>
<p>이름처럼 새로운 스레드를 생성한다. 새로운 스레드를 만들어 동작을 실행하고 싶을 때 <code>Schedulers.newThread()</code>를 인자로 넣어주면 된다. 그럼 뉴 스레드 스케줄러는 요청을 받을 때마다 새로운 스레드를 생성한다.</p>
<p>뉴 스레드 스케줄러는 새로운 스레드를 생성하여 내가 원하는 동작을 처리하는 방법이다. 하지만 적극적으로 추천하는 방법은 아니다. RxJava에는 뉴 스레드 스케줄러보다 활용도가 높은 계산 스케줄러와 IO 스케줄러와 같은 다른 스케줄러를 제공하기 때문이다.</p>
<p><strong>2. 계산 스케줄러</strong></p>
<p>4장에서 봤던 interval() 함수는 기본적으로 계산 스케줄러에서 동작한다. 물론 내가 원하는 스케줄러에서 동작하도록 변경할 수도 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SchedulerSupport</span>(SchedulerSupport.CUSTOM)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Observable&lt;Long&gt; <span class="title">interval</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">long</span> period, TimeUnit unit, Scheduler scheduler)</span></span></span><br></pre></td></tr></table></figure>
<p>CUSTOM은 원하는 스케줄러를 지정할 수 있다는 의미이다. 리액티브 함수 대부분은 마지막 인자로 스케줄러를 지정할 수 있다. flatMap()이나 scan() 함수 등은 대표적인 연산자이지만 스케줄러를 인자로 받지 않는 경우도 있다.</p>
<p>계산 스케줄러는 CPU에 대응하는 계산용 스케줄러이다. <strong>계산 작업</strong>(입출력(I/O) 작업을 하지 않는)을 할 때는 대기 시간 없이 빠르게 결과를 도출하는 것이 중요하다. 내부적으로 스레드 풀을 생성하며 스레드 개수는 기본적으로 프로세서 개수와 동일하다.</p>
<p><strong>3. IO 스케줄러</strong></p>
<p>IO 스케줄러는 네트워크상의 요청을 처리하거나 각종 입,출력 작업을 실행하기 위한 스케줄러이다. 계산 스케줄러와 다른 점은 기본적으로 생성되는 스레드 개수가 다르다는 것이다.</p>
<p><strong>즉, 계산 스케줄러는 CPU 개수만큼 스레드를 생성하지만, IO 스케줄러는 필요할 때마다 스레드를 계속 생성한다</strong>. 입,출력 작업은 비동기로 실행되지만 결과를 얻기까지 대기 시간이 길다.</p>
<p>두 스케줄러의 비교</p>
<ul>
<li>계산 스케줄러 : 일반적인 계산 작업</li>
<li>IO 스케줄러 : 네트워크상의 요청, 파일 입출력, DB 쿼리 등</li>
</ul>
<p><strong>4. 트램펄린 스케줄러</strong></p>
<p>트램펄린 스케줄러는 <strong>새로운 스레드를 생성하지 않고 현재 스레드에 무한한 크기의 대기 행렬을 생성하는 스케줄러이다.</strong> RxJava 1.x에서는 repeat() 함수와 retry() 함수의 기본 스케줄러였으나 RxJava 2.x에서는 이러한 제약이 사라졌다.</p>
<p>새로운 스레드를 생성하지 않는다는 것과 대기 행렬을 자동으로 만들어준다는 것이 뉴 스레드 스케줄러, 계산 스케줄러, IO 스케줄러와 다른 점이다.</p>
<p><strong>5. 싱글 스레드 스케줄러</strong></p>
<p>싱글 스레드 스케줄러는 RxJava 내부에서 단일 스레드를 별도로 생성하여 구독 작업을 처리한다. 단, 생성된 스레드는 여러 번 구독 요청이 와도 공통으로 사용한다.</p>
<p>리액티브 프로그래밍이 비동기 프로그래밍을 지향하기 때문에 싱글 스레드 스케줄러를 활용할 확률은 낮다.</p>
<p>트팸펄린 스케줄러 예제와 비교해보면 실행 스레드가다르다는 사실을 알 수 있다.</p>
<ul>
<li>트램펄린 스케줄러 : 메인 스레드</li>
<li>싱글 스레드 스케줄러 : RxSingleScheduler-1</li>
</ul>
<p>뒤에 <code>-1</code>과 같이 번호가 붙있지만 <strong>결국 단일 스레드만 사용한다</strong>는 사실도 확인할 수 있다.</p>
<h2 id="스케줄러를-활용하여-콜백-지옥-벗어나기">스케줄러를 활용하여 콜백 지옥 벗어나기</h2>
<p>안드로이드 개발을 한다면 가장 쉽게 접근할 수 있고 유용하게 사용할 수 있는 부분이다. 서버와 통신하는 네트워크 프로그래밍을 할 때 마주치는 <code>콜백 지옥(Callback Hell)</code>을 해결하는 것에 집중해보자.</p>
<p>RxJava의 스케줄러를 활용하면 비동기 프로그래밍 방식이 달라진다. 계산 스케줄러나 IO 스케줄러의 예제에서도 살펴봤듯이 스레드를 생성하거나 Callable, Runnable 객체를 실행하는 코드가 사라진다. <strong>리액티브 프로그래밍은 서버와 연동하는 비동기 프로그래밍을 작성할 때 큰 힘을 발휘한다.</strong></p>
<h2 id="observeon-함수의-활용">observeOn() 함수의 활용</h2>
<p>RxJava 스케줄러의 핵심은 결국 제공되는 스케줄러의 종류를 선택한 후 subscribeOn()과 observeOn() 함수를 호출하는 것이다.</p>
<ul>
<li><code>subscribeOn()</code> : Observable에서 구독자가 subscribe() 함수를 호출했을 때 데이터 흐름을 발행하는 스레드를 지정한다.(즉, 작업 스레드를 지정한다.)</li>
<li><code>observeOn()</code> : 처리된 결과를 구독자에게 전달하는 스레드를 지정한다.(UI 갱신을 위한 스레드를 지정한다.)</li>
</ul>
<p>또한, subscribeOn() 함수는 처음 지정한 스레드를 고정시키므로 다시 subscribeOn() 함수를 호출해도 무시한다. 하지만, observeOn() 함수는 다르다.</p>
<img src="/img/schedulers.png" width="700" height="200">
<ul>
<li>subscribeOn(A)를 호출했을 때는 데이터를 발행하는 첫 줄이 스레드 A에서 실행된다. 이후에는 observeOn() 함수가 호출될 때까지 스레드 A에서 실행된다.</li>
<li>observeOn(B)를 호출하면 그 다음인 두 번째 줄부터는 스레드 B에서 실행된다.</li>
<li>map(o–&gt;D) 함수는 스레드 변겨와는 상관없으므로 세 번째 줄은 계속 스레드 B에서 실행된다.</li>
<li>이제 observeOn© 함수를 호출하면 그 다음 데이터 흐름은 스레드 C에서 실행된다.</li>
</ul>
<p>요약하면 다음과 같다.</p>
<ol>
<li>subscribeOn() 함수는 한번 호출했을 때 결정한 스레드를 고정하며 이후에는 다시 호출해도 스레드가 바뀌지 않는다.</li>
<li>observeOn() 함수는 여러 번 호출할 수 있으며 그 다음부터 동작하는 스레드를 바꿀 수 있다.</li>
</ol>
<p>전통적인 스레드 프로그래밍에서는 일일이 스레드를 만들어야 하고 스레드가 늘어날 때마다 동기화하는 것이 매우 부담스럽기 때문에 이러한 로직을 구현하는 것이 매우 힘들다. 하지만 observeOn() 함수는 스레드 변경이 쉬우므로 활용할 수 있는 범위가 매우 넓다.</p>
<p>책이 있다면 책에 나와있는 openWeatherMap 예제를 실행해보는 것을 추천한다.</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/19/RxJava-Chap05-Scheduler/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/19/RxJava-Chap04-Condition/"
                            aria-label=": [RxJava] Chap04. 조건 및 기타 연산자"
                        >
                            [RxJava] Chap04. 조건 및 기타 연산자
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-19T18:04:52+09:00">
	
		    Jun 19, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/RxJava/">RxJava</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="조건-연산자">조건 연산자</h2>
<p>조건 연산자는 Observable의 흐름을 제어하는 역할을 한다. filter 연산자가 발행된 값을 채택하느냐 기각하느냐 여부에 초점을 맞춘다면, 조건 연산자는 지금까지의 흐름을 어떻게 제어할 것인지에 초점을 맞춘다.</p>
<p>다음과 같은 연산자가 있다.</p>
<ul>
<li>amb()</li>
<li>takeUntil()</li>
<li>skipUntil()</li>
<li>all()</li>
</ul>
<p><strong>1. amb()</strong></p>
<p>amb는 ambiguous(모호한)라는 영어 단어의 줄임말이다. 여러 개의 Observable 중에서 1개의 Observable을 선택하는데, <strong>선택 기준은 가장 먼저 데이터를 발행하는 발행하는 Observable이다. 이후에 나머지 Observable에서 발행하는 데이터는 모두 무시한다.</strong></p>
<img src="/img/rx_amb.png" width="500" height="200">
<p>List 인터페이스처럼 Iterable&lt;Observable<t>&gt; 객체를 인자로 넣으면 그 중에서 가장 먼저 데이터를 발행하는 Observable만 선택해서 계속 값을 발행하도록 해준다.</t></p>
<p><strong>2. takeUntil()</strong></p>
<p><code>takeUntil()</code> 함수는 take() 함수에 조건을 설정할 수 있다. 구체적으로 살펴보면 인자로 받은 Observable에서 어떤 값을 발행하면 현재 Observable의 데이터 발행을 중단하고 즉시 완료(onComplete 이벤트 발생)한다. <strong>즉, take() 함수처럼 일정 개수만 값을 발행하되 완료 기준을 다른 Observable에서 값을 발행하는지로 판단하는 것이다.</strong></p>
<img src="/img/rx_takeUntil.png" width="500" height="200">
<p><strong>3. skipUntil()</strong></p>
<p>takeUntil()과 정반대의 함수이다. other Observable을 인자로 받는다는 점은 같지만 Observable에서 데이터를 발행할 때까지 값을 건너뛴다.</p>
<img src="/img/rx_skipUntil.png" width="500" height="200">
<p>takeUntil() 함수와는 다르게 other Observable에서 화살표가 나올 때까지는 값을 발행하지 않고 건너뛰다가 other Observable에서 값을 발행하는 순간부터 원래 Observable에서 값을 정상적으로 발행하기 시작한다.</p>
<p><strong>4. all()</strong></p>
<p>all() 함수는 단순하다. 주어진 조건에 100% 맞을 때만 true 값을 발행하고 조건에 맞지 않는 데이터가 발행되면 바로 false 값을 발행한다.</p>
<img src="/img/rx_all.png" width="500" height="200">
<p>위의 마블 다이어그램은 ‘1’ 원부터 ‘6’ 원까지 모두 ‘원’ 모양이어야만 true를 발행한다.<br>
all() 함수의 원형은 다음과 같다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SchedulerSupport</span>(SchedulerSupport.NONE)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Single&lt;Boolean&gt; <span class="title">all</span><span class="params">(Predicate&lt;? <span class="keyword">super</span> T&gt; predicate)</span></span></span><br></pre></td></tr></table></figure>
<p>predicate 인자는 filter() 함수의 인자와 동일하다. 주어진 람다 표현식이 true인지 false인지를 판정해주어야 한다.</p>
<h2 id="수학-및-기타-연산자">수학 및 기타 연산자</h2>
<p>max(), sum()과 같은 수학 함수와 기타 분류에 해당하는 함수가 있다.</p>
<p>RxJavaMath가 있지만, RxJava 2.x를 지원하지 않으므로 다른 라이브러리를 사용한다. <code>Rxjava2Extensions</code> 라이브러리를 활용해 간단한 수학 함수 및 집합 함수의 활용법을 공부해보자.</p>
<p><strong>1. 수학 함수</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MathSample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        executeMath();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">executeMath</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Integer[] data = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. count</span></span><br><span class="line">        Single&lt;Long&gt; source = Observable.fromArray(data)</span><br><span class="line">                .count();</span><br><span class="line">        source.subscribe(count -&gt; Log.i(<span class="string">"count is "</span> + count));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. max</span></span><br><span class="line">        <span class="comment">// MathFlowable 클래스의 max() 함수를 호출해 구현한다.</span></span><br><span class="line">        <span class="comment">// to() 함수는 다른 타입으로 변환해주기 위한 함수.</span></span><br><span class="line">        Flowable.fromArray(data)</span><br><span class="line">                .to(MathFlowable::max)</span><br><span class="line">                .subscribe(max -&gt; Log.i(<span class="string">"max is "</span> + max));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. min</span></span><br><span class="line">        Flowable.fromArray(data)</span><br><span class="line">                .to(MathFlowable::min)</span><br><span class="line">                .subscribe(min -&gt; Log.i(<span class="string">"min is "</span> + min));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. sum</span></span><br><span class="line">        Flowable&lt;Integer&gt; flowable = Flowable.fromArray(data)</span><br><span class="line">                .to(MathFlowable::sumInt);</span><br><span class="line">        flowable.subscribe(sum -&gt; Log.i(<span class="string">"sum is "</span> + sum));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5. average</span></span><br><span class="line">        Flowable&lt;Double&gt; flowable1 = Observable.fromArray(data)</span><br><span class="line">                .toFlowable(BackpressureStrategy.BUFFER)</span><br><span class="line">                .to(MathFlowable::averageDouble);</span><br><span class="line">        flowable1.subscribe(avg -&gt; Log.i(<span class="string">"avg is "</span> + avg));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 결과</span></span><br><span class="line">main | value = count is <span class="number">4</span></span><br><span class="line">main | value = max is <span class="number">4</span></span><br><span class="line">main | value = min is <span class="number">1</span></span><br><span class="line">main | value = sum is <span class="number">10</span></span><br><span class="line">main | value = avg is <span class="number">2.5</span></span><br></pre></td></tr></table></figure>
<p><strong>2. delay()</strong></p>
<p>delay() 함수는 시간을 인자로 받는다. 앞에서 봤던 시간과 관련된 함수들(interval, timer, defer)이 Observable을 생성하는 역할이라면 delay() 함수는 유틸리티 연산자로서 보조 역할을 한다.</p>
<img src="/img/rx_delay.png" width="500" height="200">
<p><strong>delay() 함수의 원형</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SchedulerSupport</span>(SchedulerSupport.NONE)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Observable&lt;T&gt; <span class="title">delay</span><span class="params">(<span class="keyword">long</span> delay, TimeUnit unit)</span></span></span><br></pre></td></tr></table></figure>
<p>인자로 delay 변수와 시간 단위(ms 등)을 받는다. 그리고 intervale() 함수와 마찬가지로 계산 스케줄러에서 실행한다. <strong>즉, main 스레드가 아닌 계산을 위한 별도 스레드 풀에서 실행하는 것이다.</strong></p>
<p><strong>3. timeInterval()</strong></p>
<p>어떤 값을 발행했을 때 이전 값을 발행한 이후 얼마나 시간이 흘렀는지를 알려준다.</p>
<p><strong>timeInterval() 함수의 원형</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SchedulerSupport</span>(SchedulerSupport.NONE)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> Observable&lt;Timed&lt;T&gt;&gt; timeIntervale()</span><br></pre></td></tr></table></figure>
<p>Timed<t> 객체에는 다음처럼 시간을 얻어오거나 Observable의 데이터를 얻을 수 있는 메소드를 제공할 수 있다.</t></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">value</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> TimeUnit <span class="title">unit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">time</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">time</span><span class="params">(TimeUnit unit)</span></span></span><br></pre></td></tr></table></figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/19/RxJava-Chap04-Condition/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/06/13/DesignPattern-CommandPattern/"
                            aria-label=": [Design Pattern] 커맨드 패턴"
                        >
                            [Design Pattern] 커맨드 패턴
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-06-13T14:13:21+09:00">
	
		    Jun 13, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Design-Pattern/">Design Pattern</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="커맨드-패턴이란">커맨드 패턴이란</h2>
<ul>
<li><strong>실행될 기능을 캡슐화함으로써</strong> 주어진 여러 기능을 실행할 수 있는 <code>재사용성이 높은 클래스를 설계하는 패턴</code>이다.
<ul>
<li>즉, 이벤트가 발생했을 때 실행될 기능이 다양하면서도 변경이 필요한 경우에 이벤트를 발생시키는 클래스를 변경하지 않고 재사용하고자 할 때 유용하다.</li>
<li>‘행위(Behavioral) 패턴’ 중 하나이다.</li>
</ul>
</li>
</ul>
<img src="/img/command_pattern1.png" width="500" height="200">
<ul>
<li>실행될 기능을 캡슐화함으로써 기능의 실행을 요구하는 호출자(위 그림에서 Invoker) 클래스와 실제 기능을 실행하는 수신자(Receiver) 클래스 사이의 <code>의존성을 제거</code>한다.</li>
<li>따라서 실행될 기능의 변경에도 호출자 클래스의 수정 없이 그대로 사용할 수 있도록 해준다.</li>
<li>위 그림에서 각 역할이 수행하는 작업
<ul>
<li><strong>Command</strong>
<ul>
<li>실행될 기능에 대한 인터페이스</li>
<li>실행될 기능을 execute 메소드로 선언한다.</li>
</ul>
</li>
<li><strong>ConcreteCommand</strong>
<ul>
<li>실제로 실행되는 기능을 구현한다.</li>
<li>즉, Command 인터페이스를 구현한다.</li>
</ul>
</li>
<li><strong>Invoker</strong>
<ul>
<li>기능의 실행을 요청하는 호출자 클래스</li>
</ul>
</li>
<li><strong>Receiver</strong>
<ul>
<li>ConcreteCommand에서 execute 메소드를 구현할 때 필요한 클래스</li>
<li>즉, ConcreteCommand의 기능을 실행하기 위해 사용하는 수신자 클래스</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="예시">예시</h2>
<p>개념을 어느 정도 봤으니 예시를 살펴보자. 이번에는 만능 버튼을 만들어 볼 예정이다. 버튼이 눌리면 불이 켜지는 프로그램이다.</p>
<img src="/img/command_example2.png" width="500" height="200">
<p><strong>Lamp, Button 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lamp 클래스.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Lamp</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOn</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn On!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Button 클래스.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Button</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Lamp lamp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Lamp lamp)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lamp=lamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buttonPress</span><span class="params">()</span></span>&#123;</span><br><span class="line">        lamp.turnOn();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Client 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Lamp lamp = <span class="keyword">new</span> Lamp();</span><br><span class="line">        Button button = <span class="keyword">new</span> Button(lamp);</span><br><span class="line">        button.buttonPress();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Lamp 클래스로부터 Lamp 객체를 생성한다.</li>
<li>Button 클래스의 생성자를 이용해 불을 켤 Lamp 객체를 전달한다.</li>
<li>Button 클래스의 buttonPress()가 호출되면 생성자를 통해 전달받은 Lamp 객체의 turnOn()를 호출해 불을 켠다.</li>
</ul>
<h2 id="문제점">문제점</h2>
<ol>
<li>버튼을 눌렀을 때 다른 기능을 실행하는 경우
<ul>
<li>버튼을 눌렀을 때 알람이 시작되게 하려면? 다음과 같이 수정하면 된다.</li>
</ul>
</li>
</ol>
<p><strong>Alarm, Button 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Alarm 클래스.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Alarm</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startAlarm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Start Alarm ~~~~!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 수정된 Button 클래스.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Button</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Alarm alarm;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Alarm alarm)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.alarm = alarm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buttonPress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        alarm.startAlarm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Clien 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Alarm alarm = <span class="keyword">new</span> Alarm();</span><br><span class="line">        Button button = <span class="keyword">new</span> Button(alarm);</span><br><span class="line">        button.buttonPress();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>새로운 기능으로 변경하려고 기존 코드인 Button 클래스의 내용을 수정했다. 이로 인해 OCP 원칙에 위배된다.</li>
<li>Button 클래스의 buttonPress() 전체를 변경해야 한다.</li>
</ul>
<ol start="2">
<li>버튼을 누르는 동작에 따라 다른 기능을 실행하는 경우
<ul>
<li>버튼을 처음 눌렀을 때는 램프를 켜고, 두 번째 눌렀을 때는 알람을 동작하게 하려면?</li>
</ul>
</li>
</ol>
<p><strong>수정된 Button 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Button</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Alarm alarm;</span><br><span class="line">    <span class="keyword">private</span> Lamp lamp;</span><br><span class="line">    <span class="keyword">private</span> Mode mode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 생성자에서 버튼을 눌렀을 필요한 기능을 인자로 받는다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Alarm alarm, Lamp lamp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.alarm = alarm;</span><br><span class="line">        <span class="keyword">this</span>.lamp = lamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 램프 모드 또는 알람 모드를 설정.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMode</span><span class="params">(Mode mode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mode = mode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 설정된 모드에 따라서 램프를 켜거나 알람을 시작한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buttonPress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (mode) &#123;</span><br><span class="line">            <span class="keyword">case</span> LAMP:</span><br><span class="line">                lamp.turnOn();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> ALARM:</span><br><span class="line">                alarm.startAlarm();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>필요한 기능을 새로 추가할 때마다 Button 클래스의 코드를 수정해야 한다. 따라서 재사용하기 굉장히 어렵다.</p>
<h2 id="해결책">해결책</h2>
<p>문제를 해결하기 위해서는 구체적인 기능을 직접 구현하는 대신 <strong>실행될 기능을 캡슐화해야 한다.</strong></p>
<ul>
<li>즉, Button 클래스의 buttonPress() 메소드에서 구체적인 기능(램프 켜기, 알람 동작 등)을 직접 구현하는 대신 버튼을 눌렀을 때 실행될 기능을 Button 클래스 외부에서 제공받아 캡슐화해 buttonPress() 메소드에서 호출한다.</li>
<li>이를 통해서 Button 클래스 코드를 수정하지 않고도 그대로 사용할 수 있다.</li>
</ul>
<img src="/img/command_solution.png" width="500" height="200">
<ul>
<li>Button 클래스는 미리 약속된 <strong>Command 인터페이스의 execute 메소드를 호출한다.</strong>
<ul>
<li>램프를 켜는 경우에는 theLamp.turnOn() 메소드를 호출하고 알람이 동작하는 경우에는 theAlarm.start() 메소드를 호출하도록 buttonPress() 메소드를 수정한다.</li>
</ul>
</li>
<li>LampOnCommand 클래스에서는 <strong>Command 인터페이스의 execute</strong> 메소드를 구현해 Lamp 클래스의 turnOn() 메소드를 호출한다.(램프 켜는 기능)</li>
<li>마찬가지로 AlarmStartCommand 클래스에서는 <strong>Command 인터페이스의 execute</strong> 메소드를 구현해 Alarm 클래스의 start() 메소드를 호출한다.(알람이 울리는 기능)</li>
</ul>
<p><strong>Command 인터페이스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Button 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Button</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Command command;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 생성자에서 버튼을 눌렀을 때 필요한 기능을 인자로 받는다.</span></span><br><span class="line">    Button(Command command) &#123;</span><br><span class="line">        setCommand(command);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command command)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.command = command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 버튼이 눌리면 주어진 Command 의 execute() 메소드를 호출한다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buttonPress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        command.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Lamp, LampOnCommand 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Lamp</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">turnOn</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Turn On!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 램프를 켜는 명령을 수행하는 LampOnCommand 클래스.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LampOnCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Lamp theLamp;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LampOnCommand</span><span class="params">(Lamp lamp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.theLamp = lamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Command 인터페이스의 execute() 메소드 실행.</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        theLamp.turnOn();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Alarm, AlarmStartCommand 클래스</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Alarm</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startAlarm</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Start Alarm ~~~~!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 알람을 울리는 명령을 수행하는 AlarmStartCommand 클래스.</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AlarmStartCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Alarm theAlarm;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AlarmStartCommand</span><span class="params">(Alarm alarm)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.theAlarm = alarm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        theAlarm.startAlarm();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Client에서 사용</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommandClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Lamp lamp = <span class="keyword">new</span> Lamp();</span><br><span class="line">        Alarm alarm = <span class="keyword">new</span> Alarm();</span><br><span class="line"></span><br><span class="line">        Command lampOnCommand = <span class="keyword">new</span> LampOnCommand(lamp);</span><br><span class="line">        Command alarmStartCommand = <span class="keyword">new</span> AlarmStartCommand(alarm);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Lamp 를 켜는 Command 를 설정.</span></span><br><span class="line">        Button button = <span class="keyword">new</span> Button(lampOnCommand);</span><br><span class="line">        button.buttonPress(); <span class="comment">// 램프를 켜는 기능 수행.</span></span><br><span class="line"></span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="comment">// 알람을 울리는 Command 를 설정.</span></span><br><span class="line">        Button button1 = <span class="keyword">new</span> Button(alarmStartCommand);</span><br><span class="line">        button1.buttonPress(); <span class="comment">// 알람 울리는 기능 수행.</span></span><br><span class="line">        button1.setCommand(lampOnCommand); <span class="comment">// 다시 램프를 켜는 Command 로 설정.</span></span><br><span class="line">        button1.buttonPress(); <span class="comment">// 램프를 켜는 기능 수행.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Command 인터페이스를 구현하는 LampOnCommand와 AlarmStartCommand 객체를 Button 객체에 설정한다.(setCommand() 메소드를 통해서)</li>
<li>Button 클래스의 buttonPress() 메소드에서 Command 인터페이스의 execute() 메소드를 호출한다.</li>
<li>즉, 버튼을 눌렀을 때 필요한 임의의 기능은 Command 인터페이스를 구현한 클래스의 객체를 Button 객체에 설정해서 실행할 수 있다.</li>
<li>이렇게 Command 패턴을 이용하면 Button 클래스의 코드를 변경하지 않으면서 다양한 동작을 구현할 수 있게 된다.</li>
</ul>
<img src="/img/command_solution2.png" width="500" height="200">
<h2 id="정리">정리</h2>
<p>커맨드 패턴을 적용하지 않은 경우, Button에 많은 기능이 추가될수록 Button 클래스가 가지고 있는 객체 프로퍼티는 더욱 늘어날 것이고 기존의 buttonPress() 메소드에서 분기가 더 늘어날 것이다. 이는 결국 OCP에 위배된다.</p>
<p>커맨드 패턴을 적용하면, Button이 할 수 있는 기능들(램프를 킨다, 알람을 시작한다.)을 클래스로 만든다. 즉, 기능을 수행하도록 명령을 내리는 클래스(LampOnCommand, AlarmStartCommand)로 만들어서 각 기능들을 캡슐화 한다.</p>
<p>그리고 Button 클래스의 buttonPress() 메소드에서 lamp.turnOn(), alarm.start()와 같이 기능들을 직접 호출하지 않고, 캡슐화한 Command 인터페이스의 execute() 메소드를 호출하도록 한다.</p>
<p>만약 버튼에 TV를 틀어주는 기능이 추가된다면 TvOnCommand 클래스와 TV 클래스를 추가하면 되므로, 기존의 코드를 수정할 필요가 없다. 따라서 OCP에 위배되지 않으면서 기능을 추가할 수 있다.</p>
<h2 id="참고">참고</h2>
<ul>
<li><a href="https://gmlwjd9405.github.io/2018/07/07/command-pattern.html" target="_blank" rel="noopener">[Design Pattern] 커맨드 패턴이란</a></li>
<li><a href="https://jusungpark.tistory.com/18" target="_blank" rel="noopener">디자인패턴 - 커맨드 패턴 (command pattern)</a></li>
<li><a href="https://victorydntmd.tistory.com/295" target="_blank" rel="noopener">[디자인패턴] 커맨드 패턴 (Command Pattern)</a></li>
</ul>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/06/13/DesignPattern-CommandPattern/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a
                class="btn btn--default btn--small"
                href="/archives/6/"
                aria-label="NEWER POSTS"
            >
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>NEWER POSTS</span>
            </a>
          </li>
        
        
          <li class="pagination-next">
            <a
                class="btn btn--default btn--small"
                href="/archives/8/"
                aria-label="OLDER POSTS"
            >
              <span>OLDER POSTS</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">page 7 of 28</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 VictoryWoo. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/Victory.jpeg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">VictoryWoo</h4>
        
            <div id="about-card-bio"><p>기록을 통해 사람들과 공유하는 것을 좋아합니다.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Android Developer</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->





    </body>
</html>
